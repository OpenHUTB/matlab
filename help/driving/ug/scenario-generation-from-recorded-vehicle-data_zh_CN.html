<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8"/>
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Scenario Generation from Recorded Vehicle Data</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "Automated Driving Toolbox"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../scenario-simulation.html",
          "name": "Scenario Simulation"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 3,

          "item": {
          "@id": "../cuboid-scenario-simulation.html",
          "name": "Cuboid Scenario Simulation"
}

          }
        ,
        {
          "@type": "ListItem",
          "position": 4,

          "item": {
          "@id": "../programmatic-scenario-authoring.html",
          "name": "Programmatic Scenario Authoring"
}

          }]
      }</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "programmatic-scenario-authoring"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Scenario Generation from Recorded Vehicle Data",
          "description": "Automatically generate virtual driving scenarios from recorded vehicle data.",
          "thumbnailURL": "../../examples/driving/win64/PlaybackScenarioExample_01.png",
          "genre": "Live Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "driving.PlaybackScenarioExample",
          "name": "PlaybackScenarioExample",
          "url": "scenario-generation-from-recorded-vehicle-data.html"

        }</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('driving/PlaybackScenarioExample')"

        }</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "PlaybackScenarioExample.mlx",
        "EgoUrban.txt",
        "NonEgoUrban.txt",
        "OpenDRIVEUrban.xodr",
        "urbanpreview.mp4",
        "NonEgoProperties.txt"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript"/>
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug"/>
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other"/>

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="Automatically generate virtual driving scenarios from recorded vehicle data."/>
<meta xmlns="http://www.w3.org/1999/xhtml" content="../../examples/driving/win64/PlaybackScenarioExample_01.png" itemprop="thumbnailUrl"/>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery-latest.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6.css" rel="stylesheet" type="text/css"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css"/>

<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/product_group.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../docset.xml";
            product_help_location = "driving";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/bootstrap.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"/>
<link xmlns="http://www.w3.org/1999/xhtml" href="../../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print"/>
<script xmlns="http://www.w3.org/1999/xhtml" src="../../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../documentation-center.html">Help Center</a></h1>
</div>
</div>
</div>
<div class="col-xs-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2022b" data-language="en" action="../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"/> <div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div>
</div></form>
</div>
<button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div>
<div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div>
</div>
</div>
</div>
<div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li>
</ul><ul class="nav_breadcrumb" id="ul_left_nav_productgroups"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../overview/robotics-and-autonomous-systems.html" itemprop="url"><span itemprop="title">Robotics and Autonomous Systems</span></a></li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../overview/automotive.html" itemprop="url"><span itemprop="title">Automotive</span></a></li>
</ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav">Automated Driving Toolbox</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../scenario-simulation.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Scenario Simulation</span></a></li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../cuboid-scenario-simulation.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Cuboid Scenario Simulation</span></a></li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../programmatic-scenario-authoring.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Programmatic Scenario Authoring</span></a></li>
</ul><ul class="nav_scrollspy nav">
<li class="nav_scrollspy_function"><a href="#responsive_offcanvas">Scenario Generation from Recorded Vehicle Data</a></li>
<li class="nav_scrollspy_title" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#PlaybackScenarioExample-1" class="intrnllnk">Overview</a></li>
<li><a href="#PlaybackScenarioExample-2" class="intrnllnk">Explore Recorded Vehicle Data</a></li>
<li><a href="#PlaybackScenarioExample-3" class="intrnllnk">Import ASAM OpenDRIVE Road Network into Driving Scenario</a></li>
<li><a href="#PlaybackScenarioExample-4" class="intrnllnk">Add Ego Vehicle Data from GPS to Generated Scenario</a></li>
<li><a href="#PlaybackScenarioExample-5" class="intrnllnk">Add Non-Ego Actors from Lidar Object Lists to Generated Scenario</a></li>
<li><a href="#PlaybackScenarioExample-6" class="intrnllnk">Simulate and Visualize Generated Scenario</a></li>
<li><a href="#PlaybackScenarioExample-7" class="intrnllnk">Export to ASAM OpenSCENARIO</a></li>
<li><a href="#PlaybackScenarioExample-8" class="intrnllnk">Summary</a></li>
<li><a href="#PlaybackScenarioExample-9" class="intrnllnk">Helper Functions</a></li>
<li><a href="#d124e37410" class="intrnllnk">See Also</a></li>
<li><a href="#d124e37443" class="intrnllnk">Related Examples</a></li>
<li><a href="#d124e37448" class="intrnllnk">More About</a></li>
<li><a href="#d124e37458" class="intrnllnk">External Websites</a></li>
</ul>
</nav>
</div></nav>
<script src="../../includes/product/scripts/offcanvas_v2.js"></script>
</div>
<!--END.CLASS sidebar-offcanvas--><div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 hidden-xs"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active"><a>Documentation</a></li>
<li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Examples</a></li>
<li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Functions</a></li>
<li id="crux_nav_block" class="crux_resource"><a href="../referencelist.html?type=block&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Blocks</a></li>
<li id="crux_nav_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Apps</a></li>
<li id="crux_nav_scene" class="crux_resource"><a href="../referencelist.html?type=scene&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Scenes</a></li>
</ul>
</div></nav>
</div>
<div class="visible-xs"><div class="container-fluid"><div class="row"><div class="col-xs-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources<span class="icon-arrow-down icon_16"></span></button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active"><a>Documentation</a></li>
<li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Examples</a></li>
<li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Functions</a></li>
<li id="crux_nav_mobile_block" class="crux_resource"><a href="../referencelist.html?type=block&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Blocks</a></li>
<li id="crux_nav_mobile_app" class="crux_resource"><a href="../referencelist.html?type=app&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Apps</a></li>
<li id="crux_nav_mobile_scene" class="crux_resource"><a href="../referencelist.html?type=scene&amp;category=programmatic-scenario-authoring&amp;s_tid=CRUX_topnav">Scenes</a></li>
</ul>
</div>
</div>
</div>
<div class="col-xs-3"><div class="translate_placeholder"></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">

<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div>
<section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section itemprop="content"><h1 class="r2022b" itemprop="title content" id="mw_495564cc-397a-4ae4-8125-21cddd76685f">从记录的车辆数据生成场景</h1>
<div class="examples_short_list hidden_ios_android"><div data-pane="metadata" class="panel metadata_container panel-default"><div class="panel-body metadata_content"><p class="add_margin_5">This example uses:</p>
<ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.language.introspective.showAddon('DR')">Automated Driving Toolbox</a></li>
<li><a href="matlab:matlab.internal.language.introspective.showAddon('MG')">Mapping Toolbox</a></li>
</ul>
<a class="btn btn_secondary btn-block" href="matlab:openExample('driving/PlaybackScenarioExample')" data-ex-genre="Live Script">Open Live Script</a></div>
</div>
</div>
<div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="driving-PlaybackScenarioExample"/>
<meta itemprop="exampletitle" content="Scenario Generation from Recorded Vehicle Data"/>
</div>
<span id="PlaybackScenarioExample" class="anchor_target"></span><p class="shortdesc"><span style="font-family: &quot;Microsoft YaHei&quot;;">此示例演示如何从记录的车辆数据生成虚拟驾驶场景。该方案是根据 GPS 传感器记录的位置信息和从激光雷达传感器处理的记录对象列表生成的。</span></p>
<div class="procedure"><h3 class="title" id="PlaybackScenarioExample-1">概述</h3>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">虚拟驾驶场景可用于从记录的车辆数据中重新创建真实场景。这些虚拟方案使您能够可视化和研究原始方案。由于您可以通过编程方式修改虚拟场景，因此在设计和评估自动驾驶系统时，您还可以使用它们来合成场景变体。</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">在此示例中，您将通过从测试（自我）车辆和 </span>ASAM OpenDRIVE®<span style="font-family: &quot;Microsoft YaHei&quot;;"> 文件记录的数据生成 </span> <a href="../ref/drivingscenario.html" data-docid="driving_ref#bvm8jbf" class="a"><code class="olink">drivingScenario</code></a><code class="literal"> </code><span style="font-family: &quot;Microsoft YaHei&quot;;">对象来创建虚拟驾驶方案。该 </span>ASAM OpenDRIVE <span style="font-family: &quot;Microsoft YaHei&quot;;">文件描述了记录数据的区域的道路网络。记录的车辆数据包括：</span></p>
<div class="itemizedlist"><ul><li><p><strong class="emphasis bold">GPS data</strong>: 包含每个时间戳处自我车辆的纬度和经度坐标的文本文件。</p></li>
<li><p><strong class="emphasis bold">Lidar object list data</strong>: 文本文件，其中包含每个时间戳处非自我参与者的数量及其中心相对于自我车辆的位置。</p></li>
<li><p><strong class="emphasis bold">Video data</strong>: 从安装在自我车辆上的前置单眼摄像头录制的MP4文件。</p></li>
</ul>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">若要生成和模拟驾驶场景，请执行以下步骤：</span></p>
<div class="orderedlist"><ol style="list-style: decimal;"><li><p>探索记录的车辆数据。<br/></p></li>
<li><p>将ASAM OpenDRIVE路网导入驾驶场景。<br/></p></li>
<li><p>将来自GPS的自我车辆数据添加到驾驶场景中。<br/></p></li>
<li><p>将激光雷达对象列表中的非自我Actor添加到驾驶场景中。<br/></p></li>
<li><p>模拟和可视化生成的场景。<br/></p></li>
</ol>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">下图显示了此示例中如何使用记录的数据。请注意，您可以从 GPS、激光雷达对象列表和 </span>ASAM OpenDRIVE<span style="font-family: &quot;Microsoft YaHei&quot;;"> 文件创建驾驶场景。您可以使用照相机数据来可视化原始方案，并可以将此数据与您生成的方案进行比较。您还可以使用</span> <code class="olink"><a href="../ref/geoplayer.html" data-docid="driving_ref#mw_9533ca2f-62c1-4584-8b20-a2c8570a4ed6" class="a">geoplayer</a> </code><span style="font-family: &quot;Microsoft YaHei&quot;;">在地图上可视化方案路线。</span></p>
<div class="informalfigure"><div id="d124e37197" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_01.png" height="333" width="884"/></p>
</div>
</div>
<h3 class="title" id="PlaybackScenarioExample-2">探索记录的车辆数据</h3>
<p>自车的位置是使用UBlox GPS NEO M8N传感器捕获的。GPS传感器被放置在自车车顶的中央位置。这些数据保存在名为 <code class="literal">EgoUrban.txt </code>的文本文件中。</p>
<p>非自车参与者的位置是使用Velodyne® VLP-16激光雷达传感器捕获的，其测距范围为30米。VLP-16传感器被放置在自车车顶上，位置和高度使其避免与自车车身碰撞。激光雷达传感器获取的点云数据在车辆上进行处理，以检测对象及其相对于自车的位置。这些数据保存在名为 <code class="literal">NonEgoUrban.txt </code>的文本文件中。</p>
<p>为了帮助理解原始场景，使用单目摄像头录制了一段视频作为参考。这个视频也可以用来直观地比较原始场景和生成的场景。预览版的录制视频保存在名为 <code class="literal">urbanpreview.mp4 </code>的视频文件中。您可以从 <a href="https://ssd.mathworks.com/supportfiles/driving/scenarios/Playback_City.mp4" target="_blank">here</a> 下载完整的录制视频文件。</p>
<p>生成一个用于此示例的城市交通场景的预览。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>vidObj = VideoReader(<span style="color:#A020F0">"urbanpreview.mp4"</span>);
fig = figure;
set(fig,Position=[0, 0, 800, 600]);
movegui(fig,<span style="color:#A020F0">"center"</span>);
pnl = uipanel(fig,Position=[0 0 1 1],<span style="color:#0000FF">...</span>
    Title=<span style="color:#A020F0">"Urban Traffic Scenario"</span>);
plt = axes(pnl);
<span style="color:#0000FF">while</span> hasFrame(vidObj)
    vidFrame = readFrame(vidObj);
    image(vidFrame,Parent=plt);
    plt.Visible = <span style="color:#A020F0">"off"</span>;
    pause(1/vidObj.FrameRate);
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<div class="informalfigure"><div id="d124e37221" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_02.png" width="800"/></p>
</div>
</div>
<div class="informalfigure"><div id="d124e37225" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_03.png" width="800"/></p>
</div>
</div>
<p>尽管传感器的覆盖范围可以围绕整个自车定义，但此示例仅显示前向场景。</p>
<h3 class="title" id="PlaybackScenarioExample-3">将ASAM OpenDRIVE路网导入驾驶场景</h3>
<p>用于生成虚拟场景的道路网络数据来自<a href="https://www.openstreetmap.org" target="_blank">OpenStreetMap</a>®。OpenStreetMap数据文件已转换为ASAM OpenDRIVE文件，并以<span style="font-family: monospace;">.xodr </span>扩展名保存。使用 <a href="../ref/drivingscenario.roadnetwork.html" data-docid="driving_ref#mw_0be454a9-f5f7-47a2-9a9e-9b638dbf4514" class="a"><code class="olink">roadNetwork</code></a> 函数将这个道路网络数据导入到驾驶场景中。</p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">创建驾驶场景对象并将所需的 ASAM OpenDRIVE 路网导入到生成的场景中。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>scenario = drivingScenario;
openDRIVEFile = <span style="color:#A020F0">"OpenDRIVEUrban.xodr"</span>;
roadNetwork(scenario,<span style="color:#A020F0">"OpenDRIVE"</span>,openDRIVEFile);</pre>
</div>
</div>
</div>
<h3 class="title" id="PlaybackScenarioExample-4">将 GPS 中的自我车辆数据添加到生成的场景中</h3>
<p>自车数据是从GPS传感器收集并存储为文本文件的。文本文件包含三列，分别存储自车的纬度、经度和时间戳值。使用 <code class="literal">helperGetEgoData</code> 函数将自车数据从文本文件导入到 MATLAB® 工作区中的结构体中。该结构体包含三个字段，分别指定纬度、经度和时间戳。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>egoFile = <span style="color:#A020F0">"EgoUrban.txt"</span>;
egoData = helperGetEgoData(egoFile);</pre>
</div>
</div>
</div>
<p>根据记录的GPS坐标计算自车的轨迹航点。使用 <code class="literal">latlon2local</code> 函数将原始GPS坐标转换为本地东北天的笛卡尔坐标系。转换后的坐标定义了自车的轨迹航点。 </p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Specify latitude and longitude at origin of data from ASAM OpenDRIVE file. This point will also define the origin of the local coordinate system.</span>
alt = 540.0 <span style="color:#228B22">% Average altitude in Hyderabad, India</span></pre>
</div>
</div>
</div>
<div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>alt = 540
</pre>
</div>
</div>
</div>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>origin = [17.425853702697903, 78.44939480188313, alt]; <span style="color:#228B22">% [lat, lon, altitude]</span>
<span style="color:#228B22">% Specify latitude and longitude of ego vehicle</span>
lat = egoData.lat;
lon = egoData.lon;
<span style="color:#228B22">% Compute waypoints of ego vehicle</span>
[X,Y,~] = latlon2local(lat,lon,alt,origin);
egoWaypoints(:,1) =  X;
egoWaypoints(:,2) =  Y;</pre>
</div>
</div>
</div>
<p>使用 <a href="../ref/geoplayer.html" data-docid="driving_ref#mw_9533ca2f-62c1-4584-8b20-a2c8570a4ed6" class="a"><code class="olink">geoplayer</code></a> 对象可视化自车的GPS路径。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>zoomLevel = 17;
player = geoplayer(lat(1),lon(1),zoomLevel);
plotRoute(player,lat,lon);
<span style="color:#0000FF">for</span> i = 1:size(lat,1)
    plotPosition(player,lat(i),lon(i));
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<div class="informalfigure"><div id="d124e37268" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_04.png" width="560"/></p>
</div>
</div>
<div class="informalfigure"><div id="d124e37272" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_05.png" width="800"/></p>
</div>
</div>
<p>使用 <code class="literal">helperComputeEgoData </code>函数计算自车在每个传感器数据时间戳处的速度和航向角值。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>[egoSpeed,egoAngle] = helperComputeEgoData(egoData,X,Y);</pre>
</div>
</div>
</div>
<p>将自车添加到驾驶场景中。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>ego = vehicle(scenario,ClassID=1,Name=<span style="color:#A020F0">"Ego"</span>,<span style="color:#0000FF">...</span>
    Length=3.6,Width=1.55,Height=1.6,<span style="color:#0000FF">...</span>
    Mesh=driving.scenario.carMesh);</pre>
</div>
</div>
</div>
<p>根据计算得到的自车航点集和速度，为自车创建轨迹。自车以指定的速度沿着轨迹行驶。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>trajectory(ego,egoWaypoints,egoSpeed);</pre>
</div>
</div>
</div>
<h3 class="title" id="PlaybackScenarioExample-5">将激光雷达对象列表中的非自我Actor添加到生成的场景中</h3>
<p>非自车参与者的数据是通过激光雷达传感器收集的，并以文本文件的形式存储。文本文件包含五列数据，分别存储actor IDs、x坐标、y坐标、z坐标和时间戳值。使用 <code class="literal">helperGetNonEgoData </code>函数将非自车参与者的数据从文本文件导入到MATLAB®工作区中的结构体中。输出是一个包含三个字段的结构体：</p>
<div class="orderedlist"><ol style="list-style: decimal;"><li><p><code class="literal">ActorID</code> - 方案定义的参与者标识符，指定为正整数。</p></li>
<li><p><code class="literal">Position - </code>参与者的位置，指定为<span style="font-family: &quot;Microsoft YaHei&quot;;"><span style="font-family: Arial;"> [</span><span class="emphasis" style="font-family: Arial;"><em>x</em></span><span style="font-family: Arial;"> </span><span class="emphasis" style="font-family: Arial;"><em>y</em></span><span style="font-family: Arial;"> </span><span class="emphasis" style="font-family: Arial;"><em>z</em></span><span style="font-family: Arial;">] </span>实向量。单位以米为单位。</span></p></li>
<li><p><code class="literal">Time</code> - 传感器记录的时间戳。</p></li>
</ol>
</div>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>nonEgoPosFile = <span style="color:#A020F0">"NonEgoUrban.txt"</span>;
nonEgoPropertiesFile = <span style="color:#A020F0">"NonEgoProperties.txt"</span>;
[nonEgoData, nonEgoProperties] = <span style="color:#0000FF">...</span>
    helperGetNonEgoData(nonEgoPosFile, nonEgoPropertiesFile);</pre>
</div>
</div>
</div>
<p>使用 <code class="literal">helperComputeNonEgoData</code> 函数计算每个非自车参与者在每个时间戳处的轨迹航点和速度。轨迹航点是相对于自车的计算的。</p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>actors = unique(nonEgoData(1).ActorID);
[nonEgoSpeed, nonEgoWaypoints] = <span style="color:#0000FF">...</span>
    helperComputeNonEgoData(egoData,<span style="color:#0000FF">...</span>
    egoWaypoints,nonEgoData,egoAngle);</pre>
</div>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">根据非自我参与者的 </span>class ID<span style="font-family: &quot;Microsoft YaHei&quot;;"> 确定其 </span>mesh <span style="font-family: &quot;Microsoft YaHei&quot;;">。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">for</span> i = 1:size(nonEgoProperties.ClassID,1)
    <span style="color:#0000FF">switch</span> nonEgoProperties.ClassID(i)
        <span style="color:#0000FF">case</span> 3
            nonEgoProperties.Mesh(i,1) = driving.scenario.bicycleMesh;
        <span style="color:#0000FF">case</span> 2
            nonEgoProperties.Mesh(i,1) = driving.scenario.truckMesh;
        <span style="color:#0000FF">otherwise</span>
            nonEgoProperties.Mesh(i,1) = driving.scenario.carMesh;
    <span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">将非自我参与者添加到驾驶场景中。您可以使用适当的</span>class ID, dimension, colour and mesh <span style="font-family: &quot;Microsoft YaHei&quot;;">非自我参与者。根据计算的参与者航点集和速度为非自我参与者创建轨迹。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">for</span> i = 1:size(actors,1)
        actor = vehicle(scenario,ClassID=1,<span style="color:#0000FF">...</span>
            Length=nonEgoProperties.Length(i),<span style="color:#0000FF">...</span>
            Width=nonEgoProperties.Width(i),<span style="color:#0000FF">...</span>
            Height=nonEgoProperties.Height(i),<span style="color:#0000FF">...</span>
            PlotColor=nonEgoProperties.Color(i,:),<span style="color:#0000FF">...</span>
            Mesh=nonEgoProperties.Mesh(i));
        trajectory(actor,nonEgoWaypoints{i},nonEgoSpeed{i});
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">可视化您导入到生成的场景中的自我车辆和非自我参与者。还要可视化自我车辆和非自我参与者的相应轨迹航点。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Create a custom figure window and define an axes object</span>
fig = figure;
set(fig,Position=[0, 0, 800, 600]);
movegui(fig,<span style="color:#A020F0">"center"</span>);
hViewPnl = uipanel(fig,Position=[0 0 1 1],<span style="color:#0000FF">...</span>
    Title=<span style="color:#A020F0">"Ego Vehicle and Actors"</span>);
hCarPlt = axes(hViewPnl);

<span style="color:#228B22">% Plot the generated driving scenario.</span>
plot(scenario,<span style="color:#A020F0">"Parent"</span>,hCarPlt);
axis([270 320 80 120]);
legend(<span style="color:#A020F0">"Imported Road Network"</span>,<span style="color:#A020F0">"Lanes"</span>,<span style="color:#A020F0">"Ego Vehicle"</span>,<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">"Actor 1"</span>,<span style="color:#A020F0">"Actor 2"</span>,<span style="color:#A020F0">"Actor 3"</span>,<span style="color:#A020F0">"Actor 4"</span>,<span style="color:#A020F0">"Actor 5"</span>)
legend(hCarPlt,<span style="color:#A020F0">"boxoff"</span>);</pre>
</div>
</div>
</div>
<div class="informalfigure"><div id="d124e37338" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_06.png" width="800"/></p>
</div>
</div>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>figure,
plot(egoWaypoints(:,1),egoWaypoints(:,2),<span style="color:#0000FF">...</span>
    Color=[0 0.447 0.741],LineWidth=2)
hold <span style="color:#A020F0">on</span>
<span style="color:#0000FF">for</span> i =1:size(actors,1)
    plot(nonEgoWaypoints{i}(:,1),<span style="color:#0000FF">...</span>
        nonEgoWaypoints{i}(:,2),<span style="color:#0000FF">...</span>
        Color=nonEgoProperties.Color(i,:),LineWidth=2)
<span style="color:#0000FF">end</span>
axis(<span style="color:#A020F0">"tight"</span>)
xlabel(<span style="color:#A020F0">"X (m)"</span>)
ylabel(<span style="color:#A020F0">"Y (m)"</span>)
title(<span style="color:#A020F0">"Computed Ego Vehicle and Actor Trajectories"</span>)
legend(<span style="color:#A020F0">"Ego Vehicle"</span>, <span style="color:#A020F0">"Actor 1"</span>, <span style="color:#A020F0">"Actor 2"</span>, <span style="color:#A020F0">"Actor 3"</span>,<span style="color:#0000FF">...</span>
    <span style="color:#A020F0">"Actor 4"</span>,<span style="color:#A020F0">"Actor 5"</span>,<span style="color:#A020F0">"Location"</span>,<span style="color:#A020F0">"Best"</span>)
hold <span style="color:#A020F0">off</span></pre>
</div>
</div>
</div>
<div class="informalfigure"><div id="d124e37344" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_07.png" width="560"/></p>
</div>
</div>
<h3 class="title" id="PlaybackScenarioExample-6">模拟和可视化生成的场景</h3>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">绘制场景和相应的追逐情节。运行模拟以可视化生成的驾驶场景。自我车辆和非自我行为者遵循各自的轨迹。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#228B22">% Create a custom figure window to show the scenario and chase plot</span>
figScene = figure(Name=<span style="color:#A020F0">"Driving Scenario"</span>,<span style="color:#0000FF">...</span>
    Tag=<span style="color:#A020F0">"ScenarioGenerationDemoDisplay"</span>);
set(figScene,Position=[0, 0, 1000, 400]);
movegui(figScene,<span style="color:#A020F0">"center"</span>);

<span style="color:#228B22">% Add the chase plot</span>
hCarViewPanel = uipanel(figScene,<span style="color:#0000FF">...</span>
    Position=[0.5 0 0.5 1],Title=<span style="color:#A020F0">"Chase Camera View"</span>);
hCarPlot = axes(hCarViewPanel);
chasePlot(ego,Parent=hCarPlot, Meshes=<span style="color:#A020F0">"on"</span>);

<span style="color:#228B22">% Add the top view of the generated scenario</span>
hViewPanel = uipanel(figScene,<span style="color:#0000FF">...</span>
    Position=[0 0 0.5 1],Title=<span style="color:#A020F0">"Top View"</span>);
hCarPlot = axes(hViewPanel);
chasePlot(ego,Parent=hCarPlot,Meshes=<span style="color:#A020F0">"on"</span>,<span style="color:#0000FF">...</span>
    ViewHeight=120, ViewPitch=90, ViewLocation=[0, 0]);

<span style="color:#228B22">% Run the simulation</span>
<span style="color:#0000FF">while</span> advance(scenario)
    pause(0.01)
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<div class="informalfigure"><div id="d124e37353" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_08.png" width="800"/></p>
</div>
</div>
<div class="informalfigure"><div id="d124e37357" class="mediaobject"><p><img src="../../examples/driving/win64/PlaybackScenarioExample_09.png" width="800"/></p>
</div>
</div>
<h3 class="title" id="PlaybackScenarioExample-7">导出到 ASAM OpenSCENARIO</h3>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">您还可以将方案导出到 ASAM OpenSCENARIO 文件。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>warning(<span style="color:#A020F0">"off"</span>,<span style="color:#A020F0">"driving:scenario:ExportOpenScenarioODWarning"</span>);
export(scenario, <span style="color:#A020F0">"OpenSCENARIO"</span>, <span style="color:#A020F0">"PlaybackScenarioExample.xosc"</span>);
warning(<span style="color:#A020F0">"on"</span>,<span style="color:#A020F0">"driving:scenario:ExportOpenScenarioODWarning"</span>);</pre>
</div>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">可以将ASAM OpenSCENARIO文件导入到其他工具中，以可视化添加使用相同的场景。</span></p>
<h3 class="title" id="PlaybackScenarioExample-8" _msttexthash="5618353" _msthash="89" style="font-family: &quot;Microsoft YaHei&quot;;">总结</h3>
<p><span style="font-family: &quot;Microsoft YaHei&quot;;">此示例演示如何根据使用 GPS 和激光雷达传感器记录的车辆数据自动生成虚拟驾驶场景。</span></p>
<h3 class="title" id="PlaybackScenarioExample-9">Helper Functions</h3>
<span id="mw_rtc_PlaybackScenarioExample_B0C1C517" class="anchor_target"></span><p><strong class="emphasis bold">helperGetEgoData</strong></p>
<span id="mw_rtc_PlaybackScenarioExample_86E31C69" class="anchor_target"></span><p><span style="font-family: &quot;Microsoft YaHei&quot;;">该函数从文本文件中读取自我车辆数据并转换为结构。</span></p>
<span id="mw_rtc_PlaybackScenarioExample_25C30DEA" class="anchor_target"></span><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [egoData] = helperGetEgoData(egoFile)
<span style="color:#228B22">%Read the ego vehicle data from text file</span>
fileID = fopen(egoFile);
content = textscan(fileID,<span style="color:#A020F0">'%f %f %f'</span>);
fields = {<span style="color:#A020F0">'lat'</span>,<span style="color:#A020F0">'lon'</span>,<span style="color:#A020F0">'Time'</span>};
egoData = cell2struct(content,fields,2);
fclose(fileID);
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<span id="mw_rtc_PlaybackScenarioExample_927B975C" class="anchor_target"></span><p><strong class="emphasis bold">helperGetNonEgoData </strong></p>
<span id="mw_rtc_PlaybackScenarioExample_742A4B5A" class="anchor_target"></span><p><span style="font-family: &quot;Microsoft YaHei&quot;;">此函数读取 from 文本文件中已处理的激光雷达数据和非自我执行组件属性。您可以将其转换为结构。处理后的激光雷达数据包含有关非自我参与者位置的信息，而非自我参与者属性包含有关各个非自我参与者的类型、尺寸和颜色信息。</span></p>
<span id="mw_rtc_PlaybackScenarioExample_556BBBD2" class="anchor_target"></span><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [nonEgoPos, nonEgoProperties] = <span style="color:#0000FF">...</span>
    helperGetNonEgoData(nonEgoPosFile, nonEgoPropertiesFile)
<span style="color:#228B22">% Read the processed lidar data of non-ego actors from text file.</span>
fileID1 = fopen(nonEgoPosFile);
content = textscan(fileID1,<span style="color:#A020F0">'%d %f %f %f %f'</span>);
newcontent{1} = content{1};
newcontent{2} = [content{2} content{3} content{4}];
newcontent{3} = content{5};
fields = {<span style="color:#A020F0">'ActorID'</span>,<span style="color:#A020F0">'Position'</span>,<span style="color:#A020F0">'Time'</span>};
nonEgoPos = cell2struct(newcontent,fields,2);
fclose(fileID1);

fileID2 = fopen(nonEgoPropertiesFile);
content = textscan(fileID2,<span style="color:#A020F0">'%d %f %f %f %f %f %f'</span>);
newcontent{1} = content{1};
newcontent{2} = content{2};
newcontent{3} = content{3};
newcontent{4} = content{4};
newcontent{5} = [content{5} content{6} content{7}];
fields = {<span style="color:#A020F0">'ClassID'</span>,<span style="color:#A020F0">'Length'</span>,<span style="color:#A020F0">'Width'</span>,<span style="color:#A020F0">'Height'</span>,<span style="color:#A020F0">'Color'</span>};
nonEgoProperties = cell2struct(newcontent,fields,2);
fclose(fileID2);
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<span id="mw_rtc_PlaybackScenarioExample_F2AC29C9" class="anchor_target"></span><p><strong class="emphasis bold">helperComputeEgoData </strong></p>
<span id="mw_rtc_PlaybackScenarioExample_1418E7B9" class="anchor_target"></span><p><span style="font-family: &quot;Microsoft YaHei&quot;;">该功能根据轨迹航点和时间戳计算自我飞行器的速度和航向角。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [egoSpeed, egoAngle] = <span style="color:#0000FF">...</span>
    helperComputeEgoData(egoData, X, Y)
egoTime = egoData.Time;
timeDiff = diff(egoTime);
points = [X Y];
difference  = diff(points, 1);
distance  = sqrt(sum(difference .* difference, 2));
egoSpeed = distance./timeDiff;
egoAngle = atan(diff(Y)./diff(X));
egoAngle(end+1) = egoAngle(end);
egoSpeed(end+1) = egoSpeed(end);
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
<span id="mw_rtc_PlaybackScenarioExample_8CE05336" class="anchor_target"></span><p><strong class="emphasis bold">helperComputeNonEgoData</strong></p>
<span id="mw_rtc_PlaybackScenarioExample_81B6341C" class="anchor_target"></span><p><span style="font-family: &quot;Microsoft YaHei&quot;;">该函数根据轨迹航点和时间戳计算每个非自我参与者的速度和航向角。速度和航向角是相对于自我车辆计算的。</span></p>
<div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">function</span> [nonEgoSpeed, nonEgoWaypoints] = <span style="color:#0000FF">...</span>
    helperComputeNonEgoData(<span style="color:#0000FF">...</span>
    egoData, egoWaypoints, nonEgoData, egoAngle)

actors = unique(nonEgoData.ActorID);
numActors = size(actors,1);

nonEgoWaypoints = cell(numActors, 1);
nonEgoSpeed     = cell(numActors, 1);

<span style="color:#0000FF">for</span> i = 1:numActors
    id = actors(i);
    idx = find([nonEgoData.ActorID] == id);
    actorXData = nonEgoData.Position(idx,1);
    actorYData = nonEgoData.Position(idx,2);
    actorTime = nonEgoData.Time(idx);
    actorWaypoints = [0 0];
    
    <span style="color:#228B22">% Compute the trajectory waypoints of non-ego actor</span>
    [sharedTimeStamps,nonEgoIdx,egoIdx] = <span style="color:#0000FF">...</span>
        intersect(actorTime,egoData.Time,<span style="color:#A020F0">"stable"</span>);
    tempX = actorXData(nonEgoIdx);
    tempY = actorYData(nonEgoIdx);
    relativeX = -tempX .* cos(egoAngle(egoIdx)) + tempY .* sin(egoAngle(egoIdx));
    relativeY = -tempX .* sin(egoAngle(egoIdx)) - tempY .* cos(egoAngle(egoIdx));
    actorWaypoints(nonEgoIdx,1) = egoWaypoints(egoIdx,1) + relativeX;
    actorWaypoints(nonEgoIdx,2) = egoWaypoints(egoIdx,2) + relativeY;
    
    <span style="color:#228B22">% Compute the speed values of non-ego actor</span>
    timeDiff = diff(sharedTimeStamps);
    difference = diff(actorWaypoints, 1);
    distance   = sqrt(sum(difference .* difference, 2));
    actorSpeed = distance./timeDiff;
    actorSpeed(end+1) = actorSpeed(end);
    
    <span style="color:#228B22">% Smooth the trajectory waypoints of non-ego actor</span>
    actorWaypoints = smoothdata(actorWaypoints,<span style="color:#A020F0">"sgolay"</span>);
    
    <span style="color:#228B22">% Store the values of trajectory waypoints and speed computed of each non-ego actor</span>
    nonEgoWaypoints(i) = {actorWaypoints};
    nonEgoSpeed(i) = {actorSpeed'};
<span style="color:#0000FF">end</span>
<span style="color:#0000FF">end</span></pre>
</div>
</div>
</div>
</div>
      <h2 id="d124e37410">See Also</h2>
<h3>Apps</h3>
<ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/drivingscenariodesigner-app.html"><span itemprop="name">Driving Scenario
            Designer</span></a></span></li>
</ul>
<h3>Functions</h3>
<ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/drivingscenario.roadnetwork.html"><span itemprop="name"><code class="function">roadNetwork</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/drivingscenario.trajectory.html"><span itemprop="name"><code class="function">trajectory</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/drivingscenario.vehicle.html"><span itemprop="name"><code class="function">vehicle</code></span></a></span></li>
</ul>
<h3>Objects</h3>
<ul class="list-unstyled margined_10"><li><span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/drivingscenario.html"><span itemprop="name"><code class="object">drivingScenario</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/visiondetectiongenerator-system-object.html"><span itemprop="name"><code class="object">visionDetectionGenerator</code></span></a></span> | <span itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/SeeAlso" itemprop="seealso"><a itemprop="url" href="../ref/geoplayer.html"><span itemprop="name"><code class="object">geoplayer</code></span></a></span></li>
</ul>
      <h2 id="d124e37443">Related Examples</h2>
<ul><li><a href="automatic-scenario-generation.html" class="a">Automatic Scenario Generation</a></li>
</ul>
      <h2 id="d124e37448">More About</h2>
<ul><li><a href="create-driving-scenario-programmatically.html" class="a">Create Driving Scenario Programmatically</a></li>
<li><a href="create-actor-and-vehicle-trajectories.html" class="a">Create Actor and Vehicle Trajectories Programmatically</a></li>
</ul>
    
      <h2 id="d124e37458">External Websites</h2>
<ul><li><a href="https://www.asam.net/standards/detail/opendrive/" target="_blank">ASAM OpenDRIVE</a></li>
</ul>
    </section>
    </div>
<div class="modal fade" id="open-example-dialog" tabindex="-1" role="dialog" aria-labelledby="openExampleDialogLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button><h2 class="h3 modal-title">Open Example</h2>
</div>
<div class="modal-body" id="dialog-body"><p>You have a modified version of this example. Do you want to open this example with your edits?</p>
</div>
<div class="modal-footer"><a id="open-example-dialog-replace" class="btn btn_color_blue companion_btn" data-dismiss="modal">No, open this example and discard my edits</a><a id="open-example-dialog-continue" class="btn btn_color_blue" data-dismiss="modal">Yes</a></div>
</div>
</div>
</div>
<div class="clearfix"></div>
<div align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css"/>
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script>
</div>
</section>


</div>
</div>
</div>
</div>
<!--close_0960--><footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-xs-12">
<p class="copyright">© 1994-2022 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li>
<li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li>
<li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li>
<li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li>
</ul>
</div>
</div>
</div>
</div>
</footer>
</div>
<!--close row-offcanvas--></div>
<!--close_0970-->
</body>
</html>