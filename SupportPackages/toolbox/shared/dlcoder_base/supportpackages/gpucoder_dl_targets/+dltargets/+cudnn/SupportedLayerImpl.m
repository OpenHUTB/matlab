




classdef SupportedLayerImpl<handle
    properties(Constant,Access=public)
        m_supportedLayers=dltargets.cudnn.SupportedLayerImpl.initSupportedLayers();
        m_sourceFiles=dltargets.cudnn.SupportedLayerImpl.getSourceFiles();
        m_headerFiles=dltargets.cudnn.SupportedLayerImpl.getHeaderFiles();
        componentRootDir=fullfile(matlabroot,'toolbox','gpucoder_dl_targets_src');
        rootDir=fullfile(dltargets.cudnn.SupportedLayerImpl.componentRootDir,'cudnn');
        rootHeaderDir=fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,...
        'export','include','cudnn');
    end

    methods(Static=true)

        function supportedLayers=initSupportedLayers()
            supportedLayers={'gpucoder.avg_pool_layer_comp',...
            'gpucoder.max_pool_layer_comp',...
            'gpucoder.input_layer_comp',...
            'gpucoder.conv_layer_comp',...
            'gpucoder.transposedconv_layer_comp',...
            'gpucoder.batch_norm_layer_comp',...
            'gpucoder.norm_layer_comp',...
            'gpucoder.output_layer_comp',...
            'gpucoder.fc_layer_comp',...
            'gpucoder.relu_layer_comp',...
            'gpucoder.leakyrelu_layer_comp',...
            'gpucoder.clippedrelu_layer_comp',...
            'gpucoder.softmax_layer_comp',...
            'gpucoder.pass_through_layer_comp',...
            'gpucoder.addition_layer_comp',...
            'gpucoder.MaxUnpool_layer_comp',...
            'gpucoder.fused_conv_activation_layer_comp',...
            'gpucoder.MWBfpScaleLayer',...
            'gpucoder.MWBfpRescaleLayer',...
            'MWScalingLayer',...
            'MWFlattenCStyleLayer',...
            'MWSigmoidLayer',...
            'MWTanhLayer',...
            'MWELULayer',...
            'MWYoloReorg2dLayer',...
            'MWCrop2dLayer',...
            'MWZeroPaddingLayer',...
            'MWYoloTransformLayer',...
            'MWYoloExtractionLayer',...
            'MWYoloSoftmaxLayer',...
            'MWExponentialLayer',...
            'MWRowMajorFlattenLayer',...
            'MWFlattenLayer',...
            'gpucoder.sequence_input_layer_comp',...
            'gpucoder.rnn_layer_comp',...
            'MWSplittingLayer',...
            'gpucoder.elementwise_affine_layer_comp',...
            'gpucoder.word_embedding_layer_comp',...
            'gpucoder.ssdMergeLayer',...
            'gpucoder.concatenation_layer_comp',...
            'gpucoder.sequence_folding_layer_comp',...
            'gpucoder.sequence_unfolding_layer_comp',...
            'gpucoder.MWInt8DataReorderLayer',...
            'gpucoder.conv_int8_layer_comp',...
            'gpucoder.fused_int8_conv_activation_layer_comp',...
'gpucoder.fc_int8_layer_comp'
            };
        end


        function sourceFiles=getSourceFiles()
            keys=dltargets.cudnn.SupportedLayerImpl.m_supportedLayers;
            values=cell(numel(keys),1);
            sourceFiles=containers.Map(keys,values,'UniformValues',false);
            sourceFiles('gpucoder.relu_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnReLULayerImpl.cu');
            sourceFiles('gpucoder.norm_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnNormLayerImpl.cu');
            sourceFiles('gpucoder.avg_pool_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnAvgPoolingLayerImpl.cu');
            sourceFiles('gpucoder.fc_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnFCLayerImpl.cu');
            sourceFiles('gpucoder.max_pool_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnMaxPoolingLayerImpl.cu');
            sourceFiles('gpucoder.softmax_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnSoftmaxLayerImpl.cu');
            sourceFiles('gpucoder.output_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnOutputLayerImpl.cu');
            sourceFiles('gpucoder.conv_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnConvLayerImpl.cu');
            sourceFiles('gpucoder.leakyrelu_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnLeakyReLULayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWLeakyReLULayerImplKernel.cu')};
            sourceFiles('gpucoder.clippedrelu_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnClippedReLULayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWClippedReLULayerImplKernel.cu')};
            sourceFiles('gpucoder.batch_norm_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnBatchNormalizationLayerImpl.cu');
            sourceFiles('gpucoder.transposedconv_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnTransposedConvolution2DLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCrop2dLayerImplKernel.cu')};
            sourceFiles('gpucoder.addition_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnAdditionLayerImpl.cu');
            sourceFiles('gpucoder.MaxUnpool_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnMaxUnpoolingLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWMaxUnpoolingLayerImplKernel.cu')};
            sourceFiles('gpucoder.fused_conv_activation_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnFusedConvActivationLayerImpl.cu');
            sourceFiles('MWScalingLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnScalingLayerImpl.cu');
            sourceFiles('MWFlattenCStyleLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnFlattenCStyleLayerImpl.cu');
            sourceFiles('MWSigmoidLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnSigmoidLayerImpl.cu');
            sourceFiles('MWTanhLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnTanhLayerImpl.cu');
            sourceFiles('MWELULayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnELULayerImpl.cu');
            sourceFiles('MWYoloReorg2dLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnYoloReorg2dLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWYoloReorg2dLayerImplKernel.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCrop2dLayerImplKernel.cu')};
            sourceFiles('MWCrop2dLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnCrop2dLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCrop2dLayerImplKernel.cu')};
            sourceFiles('MWZeroPaddingLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnZeroPaddingLayerImpl.cu');
            sourceFiles('MWYoloExtractionLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnYoloExtractionLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWYoloExtractionLayerImplKernel.cu')};
            sourceFiles('MWFlattenLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnFlattenLayerImpl.cu');
            sourceFiles('MWYoloSoftmaxLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnYoloSoftmaxLayerImpl.cu');
            sourceFiles('MWExponentialLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnExponentialLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWExponentialLayerImplKernel.cu')};
            sourceFiles('gpucoder.MWBfpScaleLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnBfpScaleLayerImpl.cu');
            sourceFiles('gpucoder.MWBfpRescaleLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnBfpRescaleLayerImpl.cu');
            sourceFiles('gpucoder.sequence_input_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnSequenceInputLayerImpl.cu');
            sourceFiles('gpucoder.rnn_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnRNNLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWRNNLayerImplKernel.cu')};
            sourceFiles('MWSplittingLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnSplittingLayerImpl.cu');
            sourceFiles('gpucoder.elementwise_affine_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnElementwiseAffineLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWElementwiseAffineLayerImplKernel.cu')};
            sourceFiles('gpucoder.word_embedding_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnWordEmbeddingLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWWordEmbeddingLayerImplKernel.cu')};
            sourceFiles('gpucoder.ssdMergeLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnSSDMergeLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWSSDMergeLayerImplKernel.cu')};
            sourceFiles('gpucoder.concatenation_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnConcatenationLayerImpl.cu');
            sourceFiles('gpucoder.MWInt8DataReorderLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnInt8DataReorderLayerImpl.cu');
            sourceFiles('gpucoder.conv_int8_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnInt8ConvolutionLayerImpl.cu');
            sourceFiles('gpucoder.fused_int8_conv_activation_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnInt8ConvolutionLayerImpl.cu');
            sourceFiles('gpucoder.fc_int8_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCudnnInt8FCLayerImpl.cu');

        end


        function headerFiles=getHeaderFiles()
            keys=dltargets.cudnn.SupportedLayerImpl.m_supportedLayers;
            values=cell(numel(keys),1);
            headerFiles=containers.Map(keys,values,'UniformValues',false);
            headerFiles('gpucoder.input_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnInputLayerImpl.hpp');
            headerFiles('gpucoder.relu_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnReLULayerImpl.hpp');
            headerFiles('gpucoder.norm_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnNormLayerImpl.hpp');
            headerFiles('gpucoder.avg_pool_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnAvgPoolingLayerImpl.hpp');
            headerFiles('gpucoder.fc_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnFCLayerImpl.hpp');
            headerFiles('gpucoder.max_pool_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnMaxPoolingLayerImpl.hpp');
            headerFiles('gpucoder.softmax_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnSoftmaxLayerImpl.hpp');
            headerFiles('gpucoder.output_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnOutputLayerImpl.hpp');
            headerFiles('gpucoder.conv_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnConvLayerImpl.hpp');
            headerFiles('gpucoder.leakyrelu_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnLeakyReLULayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.clippedrelu_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnClippedReLULayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.batch_norm_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnBatchNormalizationLayerImpl.hpp');
            headerFiles('gpucoder.transposedconv_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnTransposedConvolution2DLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.addition_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnAdditionLayerImpl.hpp');
            headerFiles('gpucoder.MaxUnpool_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnMaxUnpoolingLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.fused_conv_activation_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnFusedConvActivationLayerImpl.hpp');
            headerFiles('MWScalingLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnScalingLayerImpl.hpp');
            headerFiles('MWFlattenCStyleLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnFlattenCStyleLayerImpl.hpp');
            headerFiles('MWSigmoidLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnSigmoidLayerImpl.hpp');
            headerFiles('MWTanhLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnTanhLayerImpl.hpp');
            headerFiles('MWELULayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnELULayerImpl.hpp');
            headerFiles('MWYoloReorg2dLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnYoloReorg2dLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWCrop2dLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnCrop2dLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWZeroPaddingLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnZeroPaddingLayerImpl.hpp');
            headerFiles('MWYoloExtractionLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnYoloExtractionLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWYoloSoftmaxLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnYoloSoftmaxLayerImpl.hpp');
            headerFiles('MWExponentialLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnExponentialLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWFlattenLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnFlattenLayerImpl.hpp');
            headerFiles('gpucoder.MWBfpScaleLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnBfpScaleLayerImpl.hpp');
            headerFiles('gpucoder.MWBfpRescaleLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnBfpRescaleLayerImpl.hpp');
            headerFiles('gpucoder.sequence_input_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnSequenceInputLayerImpl.hpp');
            headerFiles('gpucoder.rnn_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnRNNLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWSplittingLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnSplittingLayerImpl.hpp');
            headerFiles('gpucoder.elementwise_affine_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnElementwiseAffineLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.word_embedding_layer_comp')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnWordEmbeddingLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.ssdMergeLayer')=...
            {fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnSSDMergeLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.concatenation_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnConcatenationLayerImpl.hpp');
            headerFiles('gpucoder.MWInt8DataReorderLayer')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnInt8DataReorderLayerImpl.hpp');
            headerFiles('gpucoder.conv_int8_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnInt8ConvolutionLayerImpl.hpp');
            headerFiles('gpucoder.fused_int8_conv_activation_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnInt8ConvolutionLayerImpl.hpp');
            headerFiles('gpucoder.fc_int8_layer_comp')=...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWCudnnInt8FCLayerImpl.hpp');
        end
    end
end


