










classdef SupportedLayerImpl<handle
    properties(Constant,Access=public)
        m_supportedLayers=dltargets.tensorrt.SupportedLayerImpl.initSupportedLayers();
        m_sourceFiles=dltargets.tensorrt.SupportedLayerImpl.getSourceFiles();
        m_headerFiles=dltargets.tensorrt.SupportedLayerImpl.getHeaderFiles();
        componentRootDir=fullfile(matlabroot,'toolbox','gpucoder_dl_targets_src');
        rootDir=fullfile(dltargets.tensorrt.SupportedLayerImpl.componentRootDir,'tensorrt');
        rootHeaderDir=fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,...
        'export','include','tensorrt');
    end

    methods(Static=true)

        function supportedLayers=initSupportedLayers()

            supportedLayers={'gpucoder.input_layer_comp',...
            'gpucoder.conv_layer_comp',...
            'gpucoder.transposedconv_layer_comp',...
            'gpucoder.batch_norm_layer_comp',...
            'gpucoder.norm_layer_comp',...
            'gpucoder.output_layer_comp',...
            'gpucoder.fc_layer_comp',...
            'gpucoder.relu_layer_comp',...
            'gpucoder.clippedrelu_layer_comp',...
            'gpucoder.softmax_layer_comp',...
            'gpucoder.pass_through_layer_comp',...
            'gpucoder.addition_layer_comp',...
            'gpucoder.avg_pool_layer_comp',...
            'gpucoder.leakyrelu_layer_comp',...
            'gpucoder.max_pool_layer_comp',...
            'gpucoder.MaxUnpool_layer_comp',...
            'MWScalingLayer',...
            'MWCrop2dLayer',...
            'MWYoloReorg2dLayer',...
            'MWYoloTransformLayer',...
            'MWYoloExtractionLayer',...
            'MWYoloSoftmaxLayer',...
            'MWExponentialLayer',...
            'MWSigmoidLayer',...
            'MWFlattenCStyleLayer',...
            'MWTanhLayer',...
            'MWZeroPaddingLayer',...
            'MWRowMajorFlattenLayer',...
            'gpucoder.elementwise_affine_layer_comp',...
            'MWELULayer',...
            'gpucoder.rnn_layer_comp',...
            'gpucoder.sequence_input_layer_comp',...
            'gpucoder.sequence_folding_layer_comp',...
            'gpucoder.sequence_unfolding_layer_comp',...
            'MWFlattenLayer',...
            'gpucoder.word_embedding_layer_comp',...
            'gpucoder.ssdMergeLayer',...
'gpucoder.concatenation_layer_comp'...
            ,'gpucoder.fused_conv_activation_layer_comp'
            };

        end

        function sourceFiles=getSourceFiles()
            keys=dltargets.tensorrt.SupportedLayerImpl.m_supportedLayers;
            values=cell(numel(keys),1);
            sourceFiles=containers.Map(keys,values,'UniformValues',false);
            sourceFiles('gpucoder.input_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtInputLayerImpl.cu');
            sourceFiles('gpucoder.relu_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtReLULayerImpl.cu');
            sourceFiles('gpucoder.norm_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtNormLayerImpl.cu');
            sourceFiles('gpucoder.avg_pool_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtAvgPoolingLayerImpl.cu');
            sourceFiles('gpucoder.fc_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtFCLayerImpl.cu');
            sourceFiles('gpucoder.max_pool_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtMaxPoolingLayerImpl.cu');
            sourceFiles('gpucoder.softmax_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtSoftmaxLayerImpl.cu');
            sourceFiles('gpucoder.output_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtOutputLayerImpl.cu');
            sourceFiles('gpucoder.conv_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtConvLayerImpl.cu');
            sourceFiles('gpucoder.transposedconv_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtTransposedConvolution2DLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCrop2dLayerImplKernel.cu')};
            sourceFiles('gpucoder.batch_norm_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtBatchNormalizationLayerImpl.cu');
            sourceFiles('gpucoder.addition_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtAdditionLayerImpl.cu');
            sourceFiles('gpucoder.leakyrelu_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtLeakyReLULayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWLeakyReLULayerImplKernel.cu')};
            sourceFiles('gpucoder.clippedrelu_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtClippedReLULayerImpl.cu');
            sourceFiles('MWScalingLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtScalingLayerImpl.cu');
            sourceFiles('MWCrop2dLayer')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtCrop2dLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCrop2dLayerImplKernel.cu')};
            sourceFiles('MWYoloReorg2dLayer')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtYoloReorg2dLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWYoloReorg2dLayerImplKernel.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWCrop2dLayerImplKernel.cu')};
            sourceFiles('MWYoloExtractionLayer')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtYoloExtractionLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWYoloExtractionLayerImplKernel.cu')};
            sourceFiles('MWExponentialLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtExponentialLayerImpl.cu');
            sourceFiles('MWYoloSoftmaxLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtYoloSoftmaxLayerImpl.cu');
            sourceFiles('MWSigmoidLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtSigmoidLayerImpl.cu');
            sourceFiles('gpucoder.MaxUnpool_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtMaxUnpoolingLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWMaxUnpoolingLayerImplKernel.cu')};
            sourceFiles('MWFlattenCStyleLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtFlattenCStyleLayerImpl.cu');
            sourceFiles('MWTanhLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtTanhLayerImpl.cu');
            sourceFiles('MWZeroPaddingLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtZeroPaddingLayerImpl.cu');
            sourceFiles('MWRowMajorFlattenLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtRowMajorFlattenLayerImpl.cu');
            sourceFiles('gpucoder.elementwise_affine_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtElementwiseAffineLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWElementwiseAffineLayerImplKernel.cu')};
            sourceFiles('MWELULayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtELULayerImpl.cu');
            sourceFiles('gpucoder.rnn_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtRNNLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWRNNLayerImplKernel.cu')};
            sourceFiles('gpucoder.sequence_input_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtSequenceInputLayerImpl.cu');
            sourceFiles('gpucoder.sequence_folding_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtSequenceFoldingLayerImpl.cu');
            sourceFiles('gpucoder.sequence_unfolding_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtSequenceUnfoldingLayerImpl.cu');
            sourceFiles('MWFlattenLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtFlattenLayerImpl.cu');
            sourceFiles('gpucoder.word_embedding_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtWordEmbeddingLayerImpl.cu'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootDir,'MWWordEmbeddingLayerImplKernel.cu')};
            sourceFiles('gpucoder.ssdMergeLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtSSDMergeLayerImpl.cu');
            sourceFiles('gpucoder.concatenation_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtConcatenationLayerImpl.cu');
            sourceFiles('gpucoder.fused_conv_activation_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootDir,'MWTensorrtFusedConvActivationLayerImpl.cu');

        end

        function headerFiles=getHeaderFiles()
            keys=dltargets.tensorrt.SupportedLayerImpl.m_supportedLayers;
            values=cell(numel(keys),1);
            headerFiles=containers.Map(keys,values,'UniformValues',false);
            headerFiles('gpucoder.input_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtInputLayerImpl.hpp');
            headerFiles('gpucoder.relu_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtReLULayerImpl.hpp');
            headerFiles('gpucoder.norm_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtNormLayerImpl.hpp');
            headerFiles('gpucoder.avg_pool_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtAvgPoolingLayerImpl.hpp');
            headerFiles('gpucoder.fc_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtFCLayerImpl.hpp');
            headerFiles('gpucoder.max_pool_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtMaxPoolingLayerImpl.hpp');
            headerFiles('gpucoder.softmax_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtSoftmaxLayerImpl.hpp');
            headerFiles('gpucoder.output_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtOutputLayerImpl.hpp');
            headerFiles('gpucoder.conv_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtConvLayerImpl.hpp');
            headerFiles('gpucoder.transposedconv_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtTransposedConvolution2DLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.batch_norm_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtBatchNormalizationLayerImpl.hpp');
            headerFiles('gpucoder.addition_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtAdditionLayerImpl.hpp');
            headerFiles('gpucoder.leakyrelu_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtLeakyReLULayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.clippedrelu_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtClippedReLULayerImpl.hpp');
            headerFiles('MWScalingLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtScalingLayerImpl.hpp');
            headerFiles('MWCrop2dLayer')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtCrop2dLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWYoloReorg2dLayer')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtYoloReorg2dLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWYoloExtractionLayer')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtYoloExtractionLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWExponentialLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtExponentialLayerImpl.hpp');
            headerFiles('MWYoloSoftmaxLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtYoloSoftmaxLayerImpl.hpp');
            headerFiles('MWSigmoidLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtSigmoidLayerImpl.hpp');
            headerFiles('gpucoder.MaxUnpool_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtMaxUnpoolingLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWFlattenCStyleLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtFlattenCStyleLayerImpl.hpp');
            headerFiles('MWTanhLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtTanhLayerImpl.hpp');
            headerFiles('MWZeroPaddingLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtZeroPaddingLayerImpl.hpp');
            headerFiles('MWRowMajorFlattenLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtRowMajorFlattenLayerImpl.hpp');
            headerFiles('gpucoder.elementwise_affine_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtElementwiseAffineLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('MWELULayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtELULayerImpl.hpp');
            headerFiles('gpucoder.rnn_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtRNNLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.sequence_input_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtSequenceInputLayerImpl.hpp');
            headerFiles('gpucoder.sequence_folding_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtSequenceFoldingLayerImpl.hpp');
            headerFiles('gpucoder.sequence_unfolding_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtSequenceUnfoldingLayerImpl.hpp');
            headerFiles('MWFlattenLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtFlattenLayerImpl.hpp');
            headerFiles('gpucoder.word_embedding_layer_comp')=...
            {fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtWordEmbeddingLayerImpl.hpp'),...
            fullfile(dltargets.cudnn.SupportedLayerImpl.rootHeaderDir,'MWKernelHeaders.hpp')};
            headerFiles('gpucoder.ssdMergeLayer')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtSSDMergeLayerImpl.hpp');
            headerFiles('gpucoder.concatenation_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtConcatenationLayerImpl.hpp');
            headerFiles('gpucoder.fused_conv_activation_layer_comp')=...
            fullfile(dltargets.tensorrt.SupportedLayerImpl.rootHeaderDir,'MWTensorrtFusedConvActivationLayerImpl.hpp');

        end

    end


end


