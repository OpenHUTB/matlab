function[phi,zeta1,zeta2,summ,init,cwrk]=cunik(zr,fnu,ikflg,ipmtr,tol,init,cwrk)











%#codegen

    coder.allowpcode('plain');
    if nargin<7
        cwrk=complex(zeros(16,1,'like',zr));
    end
    CONr=[3.98942280401432678E-01;1.25331413731550025E+00];
    C=[
    1.00000000000000000E+00;-2.08333333333333333E-01;
    1.25000000000000000E-01;3.34201388888888889E-01;
    -4.01041666666666667E-01;7.03125000000000000E-02;
    -1.02581259645061728E+00;1.84646267361111111E+00;
    -8.91210937500000000E-01;7.32421875000000000E-02;
    4.66958442342624743E+00;-1.12070026162229938E+01;
    8.78912353515625000E+00;-2.36408691406250000E+00;
    1.12152099609375000E-01;-2.82120725582002449E+01;
    8.46362176746007346E+01;-9.18182415432400174E+01;
    4.25349987453884549E+01;-7.36879435947963170E+00;
    2.27108001708984375E-01;2.12570130039217123E+02;
    -7.65252468141181642E+02;1.05999045252799988E+03;
    -6.99579627376132541E+02;2.18190511744211590E+02;
    -2.64914304869515555E+01;5.72501420974731445E-01;
    -1.91945766231840700E+03;8.06172218173730938E+03;
    -1.35865500064341374E+04;1.16553933368645332E+04;
    -5.30564697861340311E+03;1.20090291321635246E+03;
    -1.08090919788394656E+02;1.72772750258445740E+00;
    2.02042913309661486E+04;-9.69805983886375135E+04;
    1.92547001232531532E+05;-2.03400177280415534E+05;
    1.22200464983017460E+05;-4.11926549688975513E+04;
    7.10951430248936372E+03;-4.93915304773088012E+02;
    6.07404200127348304E+00;-2.42919187900551333E+05;
    1.31176361466297720E+06;-2.99801591853810675E+06;
    3.76327129765640400E+06;-2.81356322658653411E+06;
    1.26836527332162478E+06;-3.31645172484563578E+05;
    4.52187689813627263E+04;-2.49983048181120962E+03;
    2.43805296995560639E+01;3.28446985307203782E+06;
    -1.97068191184322269E+07;5.09526024926646422E+07;
    -7.41051482115326577E+07;6.63445122747290267E+07;
    -3.75671766607633513E+07;1.32887671664218183E+07;
    -2.78561812808645469E+06;3.08186404612662398E+05;
    -1.38860897537170405E+04;1.10017140269246738E+02;
    -4.93292536645099620E+07;3.25573074185765749E+08;
    -9.39462359681578403E+08;1.55359689957058006E+09;
    -1.62108055210833708E+09;1.10684281682301447E+09;
    -4.95889784275030309E+08;1.42062907797533095E+08;
    -2.44740627257387285E+07;2.24376817792244943E+06;
    -8.40054336030240853E+04;5.51335896122020586E+02;
    8.14789096118312115E+08;-5.86648149205184723E+09;
    1.86882075092958249E+10;-3.46320433881587779E+10;
    4.12801855797539740E+10;-3.30265997498007231E+10;
    1.79542137311556001E+10;-6.56329379261928433E+09;
    1.55927986487925751E+09;-2.25105661889415278E+08;
    1.73951075539781645E+07;-5.49842327572288687E+05;
    3.03809051092238427E+03;-1.46792612476956167E+10;
    1.14498237732025810E+11;-3.99096175224466498E+11;
    8.19218669548577329E+11;-1.09837515608122331E+12;
    1.00815810686538209E+12;-6.45364869245376503E+11;
    2.87900649906150589E+11;-8.78670721780232657E+10;
    1.76347306068349694E+10;-2.16716498322379509E+09;
    1.43157876718888981E+08;-3.87183344257261262E+06;
    1.82577554742931747E+04;2.86464035717679043E+11;
    -2.40629790002850396E+12;9.10934118523989896E+12;
    -2.05168994109344374E+13;3.05651255199353206E+13;
    -3.16670885847851584E+13;2.33483640445818409E+13;
    -1.23204913055982872E+13;4.61272578084913197E+12;
    -1.19655288019618160E+12;2.05914503232410016E+11;
    -2.18229277575292237E+10;1.24700929351271032E+09;
    -2.91883881222208134E+07;1.18838426256783253E+05];

    ZERO=cast(0,'int32');
    ONE=cast(1,'int32');
    TWO=cast(2,'int32');
    FOURTEEN=cast(14,'int32');
    FIFTEEN=cast(15,'int32');
    rfn=1/fnu;
    crfn=complex(rfn);

    tst=zr;
    test=realmin('double')*1000;
    ac=fnu*test;
    if init==ZERO
        summ=complex(0);
        if abs(real(tst))>ac||abs(imag(tst))>ac
            t=zr*crfn;
            s=t*t;
            s=s+1;
            sr=sqrt(s);
            cfn=complex(fnu);
            zn=1+sr;
            zn=zn/t;
            zn=log(zn);
            zeta1=cfn*zn;
            zeta2=cfn*sr;
            sr=crfn/sr;
            cwrk(16)=sqrt(sr);
            phi=cwrk(16)*CONr(ikflg);
            if ipmtr~=ZERO
                return
            end
            t2=1/s;
            cwrk(1)=complex(1);
            crfn=complex(1);
            ac=1;
            l=ONE;
            k=FIFTEEN;
            for i=ONE:FOURTEEN
                s=complex(0);
                for j=ZERO:i
                    l=eml_plus(l,ONE,'int32','spill');
                    s=s*t2;
                    s=s+C(l);
                end
                crfn=crfn*sr;
                cwrk(i+1)=crfn*s;
                ac=ac*rfn;
                tst=cwrk(i+1);
                test=abs(real(tst))+abs(imag(tst));
                if ac<tol&&test<tol
                    k=i+1;
                    break
                end
            end
            init=k;
        else
            zeta1=complex(2*abs(log(test))+fnu);
            zeta2=complex(fnu);
            phi=complex(1);
            return
        end
    else





        zeta1=complex(0);
        zeta2=complex(0);
    end

    if ikflg==TWO

        s=complex(0);
        t=complex(1);
        for i=ONE:init
            tmp=t*cwrk(i);
            s=s+tmp;
            t=-t;
        end
        summ=s;
        phi=cwrk(16)*CONr(2);
    else

        s=complex(0);
        for i=ONE:init
            s=s+cwrk(i);
        end
        summ=s;
        phi=cwrk(16)*CONr(1);
    end
