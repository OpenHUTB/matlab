function dlgStruct=dlgValueSpecial(this,propName,parentNode,varargin)






    if ischar(this)
        feval(this,propName);
        return;
    end

    if isLibrary(this)
        globalEnable=0;
    else
        globalEnable=1;
    end

    allOpt=RptgenML.StylesheetHeaderCell.setValueSpecial;
    allOpt=[
    {'',getString(message('rptgen:RptgenML_StylesheetHeaderCell:selectTemplateLabel'))}
allOpt
    ];

    pValue=struct(findprop(this,propName));
    pValue.Description=[pValue.Description,' (XML)'];


    dlgStruct=this.dlgContainer({
    this.dlgWidget(pValue,...
    'ColSpan',[1,2],...
    'RowSpan',[1,1],...
    'Type','editarea',...
    'DialogRefresh',1,...
    'Enabled',globalEnable)
    struct('Type','combobox',...
    'Tag','ListValueSpecial',...
    'Name',getString(message('rptgen:RptgenML_StylesheetHeaderCell:appendTemplateLabel')),...
    'MatlabMethod','RptgenML.StylesheetHeaderCell.dlgValueSpecial',...
    'MatlabArgs',{{'cbkListSelect','%dialog'}},...
    'UserData',{allOpt(:,1)'},...
    'Entries',{allOpt(:,2)'},...
    'Enabled',globalEnable,...
    'ColSpan',[1,1],...
    'RowSpan',[2,2])
    struct('Type','pushbutton',...
    'Tag','setValueSpecial',...
    'ToolTip',getString(message('rptgen:RptgenML_StylesheetHeaderCell:insertTemplateAtEndLabel')),...
    'Name',getString(message('rptgen:RptgenML_StylesheetHeaderCell:appendLabel')),...
    'Enabled',false,...
    'MatlabMethod','RptgenML.StylesheetHeaderCell.setValueSpecial',...
    'MatlabArgs',{{'%source','%dialog',propName,parentNode}},...
    'DialogRefresh',true,...
    'ColSpan',[2,2],...
    'RowSpan',[2,2])
    },'',...
    'LayoutGrid',[2,2],...
    'RowStretch',[1,0],...
    'ColStretch',[1,0],...
    varargin{:});


    function cbkListSelect(dlgH)

        dlgH.setEnabled('setValueSpecial',...
        dlgH.getWidgetValue('ListValueSpecial')>0);
