
















function newObj=copySetup(this)

    propertyList=properties(this);

    params=this.ExecEnv.ConfigArgs;
    if~this.CheckInterface
        params{end+1}='checkinterface';
        params{end+1}='off';
    end

    if~this.ConfigModel
        params{end+1}='configmodel';
        params{end+1}='off';
    end

    newObj=cgv.CGV(this.ModelName,params{:});




    excludedProperties={

    'ExecEnv',...
    'MetaData',...
    'ModelName',...
    'OutputData',...
    'OutputDataName',...
    'ReportData',...
    'RunHasBeenCalled',...
    'UserConfigSetName',...
    };



    includedProperties={

    'CallbackFcn',...
    'CheckInterface',...
    'Debug',...
    'Dependencies',...
    'Description',...
    'GenerateReport',...
    'InputData',...
    'Name',...
    'OutputDir',...
    'Overwrite',...
    'PostLoadFilesList',...
    'ReturnWorkspaceOutputs',...
    'SaveFormat',...
    'SubModels',...
    'UserAddedConfigSet',...
    'UserAddedConfigSetAttachedName',...
    'UserDir',...
    'WorkDir',...
    'HeaderReportFcn',...
    'PreReportFcn',...
    'PostReportFcn',...
    'TrailerReportFcn',...
    };
    for i=1:length(includedProperties)
        newObj.(includedProperties{i})=this.(includedProperties{i});
    end
    allProperties=[excludedProperties,includedProperties];
    missing=setdiff(propertyList,allProperties);
    if~isempty(missing)
        disp(['missing properties: ',sprintf('%s, ',missing{:})]);
    end
end

