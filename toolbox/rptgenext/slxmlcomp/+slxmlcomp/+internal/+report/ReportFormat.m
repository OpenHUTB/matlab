


classdef ReportFormat
    enumeration
        HTML(...
        @createRPTGenReport,...
        'html-file',...
        fullfile(getTemplateDir(),'slxmlReportTemplate','documents','root.html'),...
        fullfile(getTemplateDir(),'slxmlDiffTemplate','documents','root.html'),...
        fullfile(getTemplateDir(),'slxmlSectionTemplate','documents','root.html'),...
        fullfile(getTemplateDir(),'slxmlSubsystemTemplate','documents','root.html'),...
        fullfile(getTemplateDir(),'subsysDiff','documents','root.html'),...
        slxmlcomp.internal.report.key.html()...
        );
        DOCX(...
        @createRPTGenReport,...
        'docx',...
        fullfile(getTemplateDir(),'slxmlReportTemplate.dotx'),...
        fullfile(getTemplateDir(),'slxmlDiffTemplate.dotx'),...
        fullfile(getTemplateDir(),'slxmlSectionTemplate.dotx'),...
        fullfile(getTemplateDir(),'slxmlSubsystemTemplate.dotx'),...
        fullfile(getTemplateDir(),'subsysDiff.dotx'),...
        slxmlcomp.internal.report.key.docx()...
        );
        PDF(...
        @createRPTGenReport,...
        'pdf',...
        fullfile(getTemplateDir(),'slxmlTemplate.pdftx'),...
        fullfile(getTemplateDir(),'slxmlTemplate.pdftx'),...
        fullfile(getTemplateDir(),'slxmlTemplate.pdftx'),...
        fullfile(getTemplateDir(),'slxmlTemplate.pdftx'),...
        fullfile(getTemplateDir(),'slxmlTemplate.pdftx'),...
        slxmlcomp.internal.report.key.pdf()...
        );
    end

    properties(Constant,Access=private)
        SupportedFormats={'html','docx','pdf'};
    end

    properties
        ReportCreator;
    end

    properties(GetAccess=public)
        RPTGenType;
        RPTGenReportTemplate;
        RPTGenDiffTemplate;
        RPTGenSectionTemplate;
        RPTGenSubsystemTemplate;
        RPTGenSubsysDiffTemplate;
        RPTGenTemplateKey;
    end

    methods
        function obj=ReportFormat(...
            reportCreator,...
            rptgenType,...
            reportTemplate,...
            diffTemplate,...
            sectionTemplate,...
            subsystemTemplate,...
            subsysDiffTemplate,...
templateKey...
            )
            obj.ReportCreator=reportCreator;
            obj.RPTGenType=rptgenType;
            obj.RPTGenReportTemplate=reportTemplate;
            obj.RPTGenDiffTemplate=diffTemplate;
            obj.RPTGenSectionTemplate=sectionTemplate;
            obj.RPTGenSubsystemTemplate=subsystemTemplate;
            obj.RPTGenSubsysDiffTemplate=subsysDiffTemplate;
            obj.RPTGenTemplateKey=templateKey;
        end

        function ext=getFileExtension(obj)
            ext=lower(char(obj));
        end

        function reportFile=createReport(obj,comparison,reportLocation)
            reportFile=obj.ReportCreator(comparison,reportLocation,obj);
        end
    end

    methods(Static,Access=public)

        function reportFormat=fromString(name)
            import slxmlcomp.internal.report.ReportFormat;
            selection=validatestring(name,ReportFormat.SupportedFormats);
            switch(selection)
            case 'html'
                reportFormat=ReportFormat.HTML;
                return;
            case 'docx'
                reportFormat=ReportFormat.DOCX;
                return;
            case 'pdf'
                reportFormat=ReportFormat.PDF;
                return;
            end
        end

    end
end

function reportFile=createRPTGenReport(comparison,reportLocation,reportFormat)
    report=slxmlcomp.internal.report.ComparisonReport(comparison,reportLocation,reportFormat);
    report.fill();
    reportFile=[reportLocation,'.',reportFormat.getFileExtension()];
end

function templateDir=getTemplateDir()
    templateDir=slxmlcomp.internal.report.util.getTemplateFolder();
end
