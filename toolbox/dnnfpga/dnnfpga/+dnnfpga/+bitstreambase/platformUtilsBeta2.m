classdef platformUtilsBeta2




    methods(Static=true)
        function addrMapObj=includeHWAddresses_integration(target)


            addrMapDUTOffsets=dnnfpga.bitstreambase.platformUtilsBeta2.includeHWAddresses(target);


            addrMapDDROffsets=dnnfpga.bitstreambase.platformUtilsBeta2.includeHWAddresses_DDRoffsets(target);

            addrMapObj=[addrMapDUTOffsets;addrMapDDROffsets];

        end

        function[ipbase,ddrbase]=baseAddr(target)

            ipbase=target.IPBaseAddr;
            ddrbase=target.DDRBaseAddr;
        end


        function addrMapObj=includeHWAddresses(target)
            [ipbase,~]=dnnfpga.bitstreambase.platformUtilsBeta2.baseAddr(target);

            addrMap={...
            {'reset_offset',hex2dec('000')},...
            {'AXI1Rd_offset',hex2dec('008')},...
            {'AXI1Wr_offset',hex2dec('00C')},...
            {'AXI2Rd_offset',hex2dec('010')},...
            {'AXI3Rd_offset',hex2dec('014')},...
            {'AXI3Wr_offset',hex2dec('018')},...
            {'conv_start_offset',hex2dec('138')},...
            {'conv_debugEnable_offset',hex2dec('140')},...
            {'conv_debugSelect_offset',hex2dec('14C')},...
            {'conv_debugValid_offset',hex2dec('160')},...
            {'conv_debugWrData_offset',hex2dec('168')},...
            {'conv_debugWrAddr_offset',hex2dec('164')},...
            {'conv_debugRdAddr_offset',hex2dec('16C')},...
            {'conv_debugRdData_offset',hex2dec('17C')},...
            {'conv_debugDMAEnable_offset',hex2dec('144')},...
            {'conv_debugDMALength_offset',hex2dec('148')},...
            {'conv_debugDMAWidth_offset',hex2dec('150')},...
            {'conv_debugDMAOffset_offset',hex2dec('154')},...
            {'conv_debugDMADirection_offset',hex2dec('158')},...
            {'conv_debugDMAStart_offset',hex2dec('15C')},...
            {'conv_dma_from_ddr4_done',hex2dec('184')},...
            {'conv_dma_to_ddr4_done',hex2dec('188')},...
            {'done',hex2dec('220')},...
            {'inputStart',hex2dec('224')},...
            {'preLoadingStart',hex2dec('228')},...
            {'nc_LCtotalLength_IP0',hex2dec('22C')},...
            {'nc_LCoffset_IP0',hex2dec('230')},...
            {'nc_LCtotalLength_Conv',hex2dec('234')},...
            {'nc_LCoffset_Conv',hex2dec('238')},...
            {'nc_LCtotalLength_OP0',hex2dec('23C')},...
            {'nc_LCoffset_OP0',hex2dec('240')},...
            {'FrameCount',hex2dec('24C')},...
            {'nc_fc_image_length',hex2dec('268')},...
            {'nc_fc_debug_dma_offset',hex2dec('26C')},...
            {'nc_fc_debug_dma_width',hex2dec('270')},...
            {'convDone',hex2dec('278')},...
            {'inputFrameOffset',hex2dec('27C')},...
            {'nc_hasFC',hex2dec('280')},...
            {'convOutputFrameOffset',hex2dec('284')},...
            {'nc_hasHS',hex2dec('288')},...
            {'HS_ddr_addr',hex2dec('28C')},...
            {'conv_weight_ddr_addr',hex2dec('290')},...
            {'fc_weight_ddr_addr',hex2dec('294')},...
            {'fc_lc_ddr_len',hex2dec('298')},...
            {'fc_lc_ddr_addr',hex2dec('29C')},...
            {'fc_layerNum',hex2dec('300')},...
            {'wr_reqCounter',hex2dec('304')}
            };
            addrMapObj=containers.Map('KeyType','char','ValueType','uint32');

            for i=1:length(addrMap)
                amap=addrMap{i};
                addrMapObj(amap{1})=ipbase+amap{2};
            end

        end


        function addrMapObj=includeHWAddresses_DDRoffsets(target)
            [~,ddrbase]=dnnfpga.bitstreambase.platformUtilsBeta2.baseAddr(target);

            addrMap={...
            {'ddrbase',ddrbase},...
            };

            addrMapObj=containers.Map('KeyType','char','ValueType','uint32');

            for i=1:length(addrMap)
                amap=addrMap{i};
                addrMapObj(amap{1})=amap{2};
            end
        end
    end
end




