classdef RowPicker<handle







    properties(Constant=true)

        cDataVal=[
        NaN,NaN,NaN,NaN,NaN,NaN,NaN
        .5,.5,.5,.5,.5,.5,.5
        0,0,0,0,0,0,0
        .5,0,0,0,0,0,.5
        NaN,0,0,0,0,0,NaN
        NaN,.5,0,0,0,.5,NaN
        NaN,NaN,0,0,0,NaN,NaN
        NaN,NaN,.5,0,.5,NaN,NaN
        NaN,NaN,NaN,0,NaN,NaN,NaN];
        LayoutRowHeight={'1x','10x'};
        LayoutColumnWidth={'1x'};
        DropDownBtnRowHeight={'1x'};
        DropDownBtnColumnWidth={'9x',7,'1x'}
        DropDownRowHeight={'1x','1x','1x','1x','1x','1x','1x'};
        DropDownColumnWidth={'1x'};
    end

    properties

Figure
Parent

Layout
DropDownBtnPanel
DropDownBtnLayout
DropDownPanel
DropDownLayout
SelectResultsLabel
DropDownBtn
SelectAllCheckBox
FriisCheckBox
HarmonicBalanceCheckBox
OutputPowerPoutCheckBox
TransducerGainGainTCheckBox
NoiseFigureNFCheckBox
OIP3CheckBox
SNRCheckBox
OIP2CheckBox


        RowSelectedFlag=ones(12,1);
        checkboxRowSelected=ones(6,1);
        HBFlag=0;
        DropdownValue=false;
    end

    methods

        function self=RowPicker(Parent)




            self.Parent=Parent;
            createComponents(self);
        end


        function resetDropDown(self,varargin)

            if self.Parent.View.UseAppContainer
                self.DropDownPanel.Visible='off';
                self.DropdownValue=0;
                self.DropDownBtn.ImageSource=repmat(self.cDataVal,1,1,3);
            else
                if~isvalid(self.DropDownPanel)
                    return;
                end
                self.DropDownPanel.Visible='off';
                self.DropDownBtn.Value=0;
                self.DropDownBtn.CData=repmat(self.cDataVal,1,1,3);
            end
        end


        function adjustDropDownPosition(self)


            self.DropDownPanel.Parent=self.DropDownBtnPanel.Parent;
            ps1=self.DropDownBtnPanel.Position;
            self.DropDownPanel.Position=[ps1(1),ps1(2)-150+2,100,150];
        end
    end

    methods(Access=private)

        function enableChkBx(self,val)


            self.OutputPowerPoutCheckBox.Enable=val;
            self.TransducerGainGainTCheckBox.Enable=val;
            self.NoiseFigureNFCheckBox.Enable=val;
            self.OIP3CheckBox.Enable=val;
            self.SNRCheckBox.Enable=val;
            self.OIP2CheckBox.Enable=val;
        end

        function setChkBx(self,val)

            self.OutputPowerPoutCheckBox.Value=val;
            self.TransducerGainGainTCheckBox.Value=val;
            self.NoiseFigureNFCheckBox.Value=val;
            self.OIP3CheckBox.Value=val;
            self.OIP2CheckBox.Value=val;
            self.SNRCheckBox.Value=val;
        end
    end

    methods(Access=private)

        function createComponents(self)


            userData=struct();
            self.Figure=self.Parent.Parent;

            widthVal=70;
            heightVal=25;
            if self.Parent.View.UseAppContainer

                self.Layout=uigridlayout(...
                'Parent',self.Parent.Layout,...
                'Scrollable','on',...
                'Tag','rowPickerLayout',...
                'RowSpacing',3,...
                'ColumnSpacing',0,...
                'Padding',[0,0,0,0],...
                'Visible',"on",...
                'RowHeight',self.LayoutRowHeight,...
                'ColumnWidth',self.LayoutColumnWidth);
                self.Layout.Layout.Row=1;
                self.Layout.Layout.Column=1;

                self.DropDownBtnLayout=uigridlayout(...
                'Parent',self.Layout,...
                'Scrollable','on',...
                'Tag','dropdownBtnLayout',...
                'RowSpacing',3,...
                'ColumnSpacing',0,...
                'Padding',[0,0,0,0],...
                'Visible',"on",...
                'RowHeight',self.DropDownBtnRowHeight,...
                'ColumnWidth',self.DropDownBtnColumnWidth);
                self.DropDownBtnLayout.Layout.Row=1;
                self.DropDownBtnLayout.Layout.Column=[1,2];

                self.SelectResultsLabel=uilabel(...
                'UserData',userData,...
                'Parent',self.DropDownBtnLayout,...
                'Text','Select Results',...
                'Position',[0,0,0.8,0.8]);
                self.SelectResultsLabel.Layout.Row=1;
                self.SelectResultsLabel.Layout.Column=1;
                if ismac||isunix
                    self.SelectResultsLabel.FontSize=7;
                end

                self.DropDownBtn=uiimage(...
                'ImageSource',repmat(self.cDataVal,1,1,3),...
                'Parent',self.DropDownBtnLayout,...
                'Tag','rowPickerDropDownCheckbox',...
                'Position',[0.8,0,0.2,1],...
                'ImageClickedFcn',@self.DropdownBtnClicked);
                self.DropDownBtn.Layout.Row=1;
                self.DropDownBtn.Layout.Column=2;
                assignVal(self);

                self.DropDownLayout=uigridlayout(...
                'Parent',self.Layout,...
                'Scrollable','on',...
                'Tag','dropdownBtnLayout',...
                'RowSpacing',3,...
                'ColumnSpacing',0,...
                'Padding',[0,0,0,0],...
                'Visible',"off",...
                'RowHeight',self.DropDownRowHeight,...
                'ColumnWidth',self.DropDownColumnWidth);
                self.DropDownLayout.Layout.Row=2;
                self.DropDownLayout.Layout.Column=[1,2];

                self.SelectAllCheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'ValueChangedFcn',@self.SelectAllCheckBoxValueChanged,...
                'Text','Select All',...
                'FontWeight','bold');
                self.SelectAllCheckBox.Layout.Row=1;
                self.SelectAllCheckBox.Layout.Column=[1,2];
                if ismac||isunix
                    self.SelectAllCheckBox.FontWeight='normal';
                end

                self.OutputPowerPoutCheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'Text','Pout',...
                'ValueChangedFcn',@self.updateTableCallback);
                self.OutputPowerPoutCheckBox.Layout.Row=2;
                self.OutputPowerPoutCheckBox.Layout.Column=[1,2];

                self.TransducerGainGainTCheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'ValueChangedFcn',@self.updateTableCallback,...
                'Text','GainT');
                self.TransducerGainGainTCheckBox.Layout.Row=3;
                self.TransducerGainGainTCheckBox.Layout.Column=[1,2];

                self.NoiseFigureNFCheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'ValueChangedFcn',@self.updateTableCallback,...
                'Text','NF');
                self.NoiseFigureNFCheckBox.Layout.Row=4;
                self.NoiseFigureNFCheckBox.Layout.Column=[1,2];

                self.OIP3CheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'ValueChangedFcn',@self.updateTableCallback,...
                'Text',...
                'OIP3');
                self.OIP3CheckBox.Layout.Row=5;
                self.OIP3CheckBox.Layout.Column=[1,2];

                self.SNRCheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'ValueChangedFcn',@self.updateTableCallback,...
                'Text','SNR');
                self.SNRCheckBox.Layout.Row=6;
                self.SNRCheckBox.Layout.Column=[1,2];

                self.OIP2CheckBox=uicheckbox(...
                'Parent',self.DropDownLayout,...
                'ValueChangedFcn',@self.updateTableCallback,...
                'Text','OIP2');
                self.OIP2CheckBox.Layout.Row=7;
                self.OIP2CheckBox.Layout.Column=[1,2];
            else

                self.DropDownPanel=uipanel(...
                'Tag','FirstPanel',...
                'Parent',self.Figure,...
                'Visible','on',...
                'BorderType','line',...
                'BorderWidth',1,...
                'HighlightColor',[.2,.2,.2],...
                'Units','pixels',...
                'Visible','off');
                self.Layout=...
                matlabshared.application.layout.GridBagLayout(...
                self.DropDownPanel,...
                'VerticalGap',0,...
                'HorizontalGap',0,...
                'VerticalWeights',[zeros(7,1);1],...
                'HorizontalWeights',[zeros(7,1);1]);

                self.SelectAllCheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'Callback',@self.SelectAllCheckBoxValueChanged,...
                'String','Select All',...
                'FontWeight','bold',...
                'Units','normalized');
                add(...
                self.Layout,self.SelectAllCheckBox,...
                1,[1,7],...
                'MinimumWidth',100,...
                'MinimumHeight',heightVal)
                if ismac||isunix
                    self.SelectAllCheckBox.FontWeight='normal';
                end

                self.OutputPowerPoutCheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'String','Pout',...
                'Callback',@self.updateTableCallback,...
                'Units','normalized');
                add(...
                self.Layout,self.OutputPowerPoutCheckBox,...
                2,[2,7],...
                'MinimumWidth',widthVal,...
                'MinimumHeight',heightVal)

                self.TransducerGainGainTCheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'Callback',@self.updateTableCallback,...
                'String','GainT',...
                'Units','normalized');
                add(...
                self.Layout,self.TransducerGainGainTCheckBox,...
                3,[2,7],...
                'MinimumWidth',widthVal,...
                'MinimumHeight',heightVal)

                self.NoiseFigureNFCheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'Callback',@self.updateTableCallback,...
                'String','NF',...
                'Units','normalized');
                add(...
                self.Layout,self.NoiseFigureNFCheckBox,...
                4,[2,7],...
                'MinimumWidth',widthVal,...
                'MinimumHeight',heightVal)

                self.OIP3CheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'Callback',@self.updateTableCallback,...
                'String','OIP3',...
                'Units','normalized');
                add(...
                self.Layout,self.OIP3CheckBox,...
                5,[2,7],...
                'MinimumWidth',widthVal,...
                'MinimumHeight',heightVal)

                self.SNRCheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'Callback',@self.updateTableCallback,...
                'String','SNR',...
                'Units','normalized');
                add(...
                self.Layout,self.SNRCheckBox,...
                6,[2,7],...
                'MinimumWidth',widthVal,...
                'MinimumHeight',heightVal)

                self.OIP2CheckBox=uicontrol(...
                'Parent',self.DropDownPanel,...
                'Style','checkbox',...
                'Callback',@self.updateTableCallback,...
                'String','OIP2',...
                'Units','normalized');
                add(...
                self.Layout,self.OIP2CheckBox,...
                7,[2,7],...
                'MinimumWidth',widthVal,...
                'MinimumHeight',heightVal)
                self.DropDownBtnPanel=uipanel(...
                'Tag','SecondPanel',...
                'Parent',self.Figure,...
                'BorderType','line',...
                'BorderWidth',1,...
                'HighlightColor',[.2,.2,.2],...
                'Units','pixels',...
                'Visible','off');
                self.SelectResultsLabel=uicontrol('Parent',self.DropDownBtnPanel,...
                'Style','text',...
                'Tag','ResultsLabel',...
                'String','Select Results',...
                'Units','normalized',...
                'Position',[0,0,0.8,0.8]);
                if ismac||isunix
                    self.SelectResultsLabel.FontSize=7;
                end
                self.DropDownBtn=uicontrol('Parent',self.DropDownBtnPanel,...
                'Style','checkbox',...
                'Tag','DropDownToggleButton',...
                'Units','normalized',...
                'CData',repmat(self.cDataVal,1,1,3),...
                'Position',[0.8,0,0.2,1],...
                'Callback',@self.DropdownBtnClicked);
                assignVal(self);
            end
        end


        function SelectAllCheckBoxValueChanged(self,~,~)


            value=self.SelectAllCheckBox.Value;
            if value==1
                self.enableChkBx('off');
                self.setChkBx(1);
            else
                self.enableChkBx('on');
                assignVal(self);
            end
            updateTableCallback(self,-1,-1);
        end

        function updateTableCallback(self,~,~)


            if self.SelectAllCheckBox.Value
                self.RowSelectedFlag=ones(12,1);
                self.Parent.updateTableDataAndColors();
                return;
            end
            self.checkboxRowSelected=[...
            self.OutputPowerPoutCheckBox.Value;...
            self.TransducerGainGainTCheckBox.Value;...
            self.NoiseFigureNFCheckBox.Value;...
            self.OIP2CheckBox.Value;...
            self.OIP3CheckBox.Value;...
            self.SNRCheckBox.Value];
            self.RowSelectedFlag=[self.checkboxRowSelected;self.checkboxRowSelected];
            self.Parent.updateTableDataAndColors();
        end

        function DropdownBtnClicked(self,~,~)


            if self.Parent.View.UseAppContainer
                self.DropdownValue=~self.DropdownValue;
            else
                self.DropdownValue=self.DropDownBtn.Value;
            end
            if self.DropdownValue
                if self.Parent.View.UseAppContainer
                    self.DropDownBtn.ImageSource=repmat(self.cDataVal(end:-1:1,:),1,1,3);
                    self.DropDownLayout.Visible='on';
                else
                    self.DropDownBtn.CData=repmat(self.cDataVal(end:-1:1,:),1,1,3);
                    self.DropDownPanel.Parent=self.DropDownBtnPanel.Parent;
                    ps1=self.DropDownBtnPanel.Position;
                    self.DropDownPanel.Position=[ps1(1),ps1(2)-150+2,100,150];
                    self.DropDownPanel.Visible='on';
                end
                if self.SelectAllCheckBox.Value
                    self.setChkBx(1)
                end
            else
                if self.Parent.View.UseAppContainer
                    self.DropDownBtn.ImageSource=repmat(self.cDataVal,1,1,3);
                    self.DropDownLayout.Visible='off';
                else
                    self.DropDownBtn.CData=repmat(self.cDataVal,1,1,3);
                    self.DropDownPanel.Visible='off';
                end
                assignVal(self);
            end
        end

        function assignVal(self)

            self.OutputPowerPoutCheckBox.Value=self.checkboxRowSelected(1);
            self.TransducerGainGainTCheckBox.Value=self.checkboxRowSelected(2);
            self.NoiseFigureNFCheckBox.Value=self.checkboxRowSelected(3);
            self.OIP3CheckBox.Value=self.checkboxRowSelected(5);
            self.SNRCheckBox.Value=self.checkboxRowSelected(6);
            self.OIP2CheckBox.Value=self.checkboxRowSelected(4);
        end
    end
end




