classdef Three_PhaseProgrammableG_class<ConvClass&handle



    properties

        OldParam=struct(...
        'Par_Vps',[],...
        'VariationStep',[],...
        'VariationRate',[],...
        'VariationMag',[],...
        'VariationFreq',[],...
        'Par_Timing_Variation',[],...
        'Yampli',[],...
        'Xtime',[],...
        'Par_HarmoA',[],...
        'Par_HarmoB',[],...
        'Par_Timing_Harmo',[],...
        'Ts',[]...
        )


        OldDropdown=struct(...
        'VariationEntity',[],...
        'VariationType',[],...
        'SinglePhase',[],...
        'HarmonicGeneration',[]...
        )


        NewDirectParam=struct(...
        'Amp',[],...
        'Amp_RampRate',[],...
        'Amp_StepValue',[],...
        'Amp_ModulationMag',[],...
        'Amp_ModulationFreq',[],...
        'Amp_Tstart',[],...
        'Amp_Tstop',[],...
        'Amp_Table',[],...
        'Amp_Time',[],...
        'Freq',[],...
        'Freq_RampRate',[],...
        'Freq_StepValue',[],...
        'Freq_ModulationMag',[],...
        'Freq_ModulationFreq',[],...
        'Freq_Tstart',[],...
        'Freq_Tstop',[],...
        'Freq_Table',[],...
        'Freq_Time',[],...
        'Phase',[],...
        'Phase_RampRate',[],...
        'Phase_StepValue',[],...
        'Phase_ModulationMag',[],...
        'Phase_ModulationFreq',[],...
        'Phase_Tstart',[],...
        'Phase_Tstop',[],...
        'Phase_Table',[],...
        'Phase_Time',[],...
        'Harmo_Ord1',[],...
        'Harmo_Mag1',[],...
        'Harmo_Phase1',[],...
        'Harmo_Tstart1',[],...
        'Harmo_Tstop1',[],...
        'Harmo_Ord2',[],...
        'Harmo_Mag2',[],...
        'Harmo_Phase2',[],...
        'Harmo_Tstart2',[],...
        'Harmo_Tstop2',[],...
        'Ts',[]...
        )


        NewDerivedParam=struct(...
        )


        NewDropdown=struct(...
        'VariationAmplitude',[],...
        'VariationFrequency',[],...
        'VariationPhase',[],...
        'Harmo_En1',[],...
        'Harmo_Seq1',[],...
        'Harmo_En2',[],...
        'Harmo_Seq2',[]...
        )


        BlockOption={...
        }
        OldBlockName=[];
        NewBlockPath=[];
        ConversionType=[];
    end

    properties(Constant)
        OldPath='powerlib_meascontrol/Pulse & Signal Generators/Three-Phase Programmable Generator'
        NewPath='elec_conv_sl_Three_PhaseProgrammableG/Three_PhaseProgrammableG'
    end

    methods
        function obj=objParamMappingDirect(obj)
            obj.NewDirectParam.Amp=ConvClass.mapDirect(obj.OldParam.Par_Vps,1);
            obj.NewDirectParam.Freq=ConvClass.mapDirect(obj.OldParam.Par_Vps,3);
            obj.NewDirectParam.Phase=ConvClass.mapDirect(obj.OldParam.Par_Vps,2);
            obj.NewDirectParam.Amp_StepValue=obj.OldParam.VariationStep;
            obj.NewDirectParam.Freq_StepValue=obj.OldParam.VariationStep;
            obj.NewDirectParam.Phase_StepValue=obj.OldParam.VariationStep;
            obj.NewDirectParam.Amp_RampRate=obj.OldParam.VariationRate;
            obj.NewDirectParam.Freq_RampRate=obj.OldParam.VariationRate;
            obj.NewDirectParam.Phase_RampRate=obj.OldParam.VariationRate;
            obj.NewDirectParam.Amp_ModulationMag=obj.OldParam.VariationMag;
            obj.NewDirectParam.Freq_ModulationMag=obj.OldParam.VariationMag;
            obj.NewDirectParam.Phase_ModulationMag=obj.OldParam.VariationMag;
            obj.NewDirectParam.Amp_ModulationFreq=obj.OldParam.VariationFreq;
            obj.NewDirectParam.Freq_ModulationFreq=obj.OldParam.VariationFreq;
            obj.NewDirectParam.Phase_ModulationFreq=obj.OldParam.VariationFreq;
            obj.NewDirectParam.Amp_Tstart=ConvClass.mapDirect(obj.OldParam.Par_Timing_Variation,1);
            obj.NewDirectParam.Amp_Tstop=ConvClass.mapDirect(obj.OldParam.Par_Timing_Variation,2);
            obj.NewDirectParam.Freq_Tstart=ConvClass.mapDirect(obj.OldParam.Par_Timing_Variation,1);
            obj.NewDirectParam.Freq_Tstop=ConvClass.mapDirect(obj.OldParam.Par_Timing_Variation,2);
            obj.NewDirectParam.Phase_Tstart=ConvClass.mapDirect(obj.OldParam.Par_Timing_Variation,1);
            obj.NewDirectParam.Phase_Tstop=ConvClass.mapDirect(obj.OldParam.Par_Timing_Variation,2);
            obj.NewDirectParam.Harmo_Tstart1=ConvClass.mapDirect(obj.OldParam.Par_Timing_Harmo,1);
            obj.NewDirectParam.Harmo_Tstop1=ConvClass.mapDirect(obj.OldParam.Par_Timing_Harmo,2);
            obj.NewDirectParam.Harmo_Tstart2=ConvClass.mapDirect(obj.OldParam.Par_Timing_Harmo,1);
            obj.NewDirectParam.Harmo_Tstop2=ConvClass.mapDirect(obj.OldParam.Par_Timing_Harmo,2);
            obj.NewDirectParam.Amp_Table=obj.OldParam.Yampli;
            obj.NewDirectParam.Freq_Table=obj.OldParam.Yampli;
            obj.NewDirectParam.Phase_Table=obj.OldParam.Yampli;
            obj.NewDirectParam.Amp_Time=obj.OldParam.Xtime;
            obj.NewDirectParam.Freq_Time=obj.OldParam.Xtime;
            obj.NewDirectParam.Phase_Time=obj.OldParam.Xtime;
            obj.NewDirectParam.Harmo_Ord1=ConvClass.mapDirect(obj.OldParam.Par_HarmoA,1);
            obj.NewDirectParam.Harmo_Mag1=ConvClass.mapDirect(obj.OldParam.Par_HarmoA,2);
            obj.NewDirectParam.Harmo_Phase1=ConvClass.mapDirect(obj.OldParam.Par_HarmoA,3);
            obj.NewDirectParam.Harmo_Ord2=ConvClass.mapDirect(obj.OldParam.Par_HarmoB,1);
            obj.NewDirectParam.Harmo_Mag2=ConvClass.mapDirect(obj.OldParam.Par_HarmoB,2);
            obj.NewDirectParam.Harmo_Phase2=ConvClass.mapDirect(obj.OldParam.Par_HarmoB,3);
            obj.NewDirectParam.Ts=obj.OldParam.Ts;
        end

        function obj=Three_PhaseProgrammableG_class()
            if nargin>0
            end
        end

        function obj=objParamMappingDerived(obj)


        end

        function obj=objDropdownMapping(obj)
            logObj=ElecAssistantLog.getInstance();
            if strcmp(obj.OldDropdown.SinglePhase,'on')
                logObj.addMessage(obj,'CheckboxNotSupported','Variation on phase A only');
            end

            newVariationTypes={'Constant','Ramp','Step','Modulation','Table'};
            switch obj.OldDropdown.VariationType
            case 'Step'
                newVariationType=newVariationTypes{3};
            case 'Ramp'
                newVariationType=newVariationTypes{2};
            case 'Modulation'
                newVariationType=newVariationTypes{4};
            case 'Table of time-amplitude pairs'
                newVariationType=newVariationTypes{5};
            end

            switch obj.OldDropdown.VariationEntity
            case 'None'
                obj.NewDropdown.VariationAmplitude='Constant';
                obj.NewDropdown.VariationFrequency='Constant';
                obj.NewDropdown.VariationPhase='Constant';
            case 'Amplitude'
                obj.NewDropdown.VariationAmplitude=newVariationType;
                obj.NewDropdown.VariationFrequency='Constant';
                obj.NewDropdown.VariationPhase='Constant';
            case 'Phase'
                obj.NewDropdown.VariationAmplitude='Constant';
                obj.NewDropdown.VariationFrequency='Constant';
                obj.NewDropdown.VariationPhase=newVariationType;
            case 'Frequency'
                obj.NewDropdown.VariationAmplitude='Constant';
                obj.NewDropdown.VariationFrequency=newVariationType;
                obj.NewDropdown.VariationPhase='Constant';
            end

            switch obj.OldDropdown.HarmonicGeneration
            case 'on'
                obj.NewDropdown.Harmo_En1='on';
                obj.NewDropdown.Harmo_En2='on';
            case 'off'
                obj.NewDropdown.Harmo_En1='off';
                obj.NewDropdown.Harmo_En2='off';
            end

            if obj.OldParam.Par_HarmoA(4)==0
                obj.NewDropdown.Harmo_Seq1='Zero Sequence'
            elseif obj.OldParam.Par_HarmoA(4)==1
                obj.NewDropdown.Harmo_Seq1='Positive Sequence'
            else
                obj.NewDropdown.Harmo_Seq1='Negative Sequence'
            end

            if obj.OldParam.Par_HarmoB(4)==0
                obj.NewDropdown.Harmo_Seq2='Zero Sequence'
            elseif obj.OldParam.Par_HarmoB(4)==1
                obj.NewDropdown.Harmo_Seq2='Positive Sequence'
            else
                obj.NewDropdown.Harmo_Seq2='Negative Sequence'
            end

        end
    end

end
