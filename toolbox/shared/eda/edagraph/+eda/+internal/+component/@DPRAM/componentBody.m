function hdlcode=componentBody(this)




    hdlcode=this.hdlcodeinit;
    addrwidth=this.generic.ADDRWIDTH.Name;
    datawidth=this.generic.DATAWIDTH.Name;

    clkA=this.findSignalName('clkA','componentBody');
    enbA=this.findSignalName('enbA','componentBody');
    wr_dinA=this.findSignalName('wr_dinA','componentBody');
    wr_addrA=this.findSignalName('wr_addrA','componentBody');
    wr_enA=this.findSignalName('wr_enA','componentBody');
    clkB=this.findSignalName('clkB','componentBody');
    enbB=this.findSignalName('enbB','componentBody');
    rd_addrB=this.findSignalName('rd_addrB','componentBody');
    rd_doutB=this.findSignalName('rd_doutB','componentBody');


    hdlcode.arch_typedefs=['  type MEMORYTYPE IS ARRAY (2**',addrwidth,' -1 DOWNTO 0) OF std_logic_vector(',datawidth,' - 1  DOWNTO 0);\n'];


    [memory,ptr]=hdlnewsignal('memory','block',-1,0,0,'MEMORYTYPE','');
    hdlcode.arch_signals=[hdlcode.arch_constants,makehdlsignaldecl(ptr)];

    hdlcode.arch_body_blocks=[...
    '--clkA port is read-write\n',...
    'clka_proc: PROCESS (',clkA,')\n',...
    'BEGIN  -- PROCESS clka_proc\n',...
    '  IF ',clkA,'''event AND ',clkA,' = ''1'' THEN\n',...
    '    IF ',enbA,' = ''1'' THEN\n',...
    '      IF ',wr_enA,' = ''1'' THEN\n',...
    '        ',memory,'(to_integer(unsigned(',wr_addrA,'))) <= ',wr_dinA,';\n',...
    '      END IF;\n',...
    '    END IF;\n',...
    '\n',...
    '  END IF;\n',...
    'END PROCESS clka_proc;\n',...
    '\n\n',...
    '--clkB port is read-only\n',...
    'clkb_proc: PROCESS (',clkB,')\n',...
    'BEGIN  -- PROCESS clkb_proc\n',...
    ' IF ',clkB,'''event AND ',clkB,' = ''1'' THEN  -- rising clock edge\n',...
    '    IF ',enbB,' = ''1'' THEN\n',...
    '      ',rd_doutB,' <= ',memory,'(to_integer(unsigned(',rd_addrB,')));\n',...
    '    END IF;\n',...
    '  END IF;\n',...
    'END PROCESS clkb_proc;\n'];
end

