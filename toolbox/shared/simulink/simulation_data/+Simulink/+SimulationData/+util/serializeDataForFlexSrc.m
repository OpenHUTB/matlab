function serializedData=serializeDataForFlexSrc(...
    inputData,interpolation,blkHandle,bdhandle)


    model=get_param(bdhandle,'Name');
    [aobHierarchy,leafSignalOffset,portBusTypes]=...
    Simulink.SimulationData.util.retrieveAoBHierarchy(model,blkHandle,[]);

    serializer=Simulink.SimulationData.SerializeInput.FlexSrcSerializer(...
    model,...
    inputData,...
    aobHierarchy,...
    interpolation,...
portBusTypes...
    );

    try
        serializedData=serializer.serialize(blkHandle);
    catch ME
        throwAsCaller(ME);
    end

    serializedData=...
    Simulink.SimulationData.util.addLeafOffsetsToSerializedDataset(...
    serializedData,...
    aobHierarchy,...
leafSignalOffset...
    );
end
