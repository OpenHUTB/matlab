function playback(viewer,waitForResponse)





    if(nargin<2)
        waitForResponse=true;
    end

    fileLoc=viewer.CZMLFile;


    viewer.GlobeViewer.Controller.visualRequest('toggleAllRendering',...
    struct(...
    'EnableRendering',false,...
    'WaitForResponse',true,...
    'EnableWindowLaunch',true,...
    'Animation','none'));
    renderCleanupObj=onCleanup(@()cleanupRenderState(viewer));
    if numel(fileLoc)>10




        viewer.GlobeViewer.Controller.RequestTimeout=Inf;
        cleanupObj=onCleanup(@()cleanupGlobeControllerTimeout(viewer));
    end
    for idx=1:numel(fileLoc)
        czmlURL=...
        globe.internal.ConnectorServiceProvider.getResourceURL(fileLoc{idx},...
        'satelliteScenarioViewer');
        data=struct(...
        'ID',viewer.CZMLFileID{idx},...
        'czml',czmlURL,...
        'RunAnimation',true,...
        'EnableDayNightLighting',true,...
        'ShowAnimationAndTimelineWidget',true,...
        'EnableWindowLaunch',true,...
        'WaitForResponse',waitForResponse,...
        'Animation','none');
        if idx==1


            viewer.NeedToSimulate=false;
        end
        viewer.GlobeViewer.Controller.visualRequest('addCZMLFile',data);
    end
    cleanupGlobeControllerTimeout(viewer);
    cleanupRenderState(viewer);
end

function cleanupGlobeControllerTimeout(viewer)
    viewer.GlobeViewer.Controller.RequestTimeout=120;
end
function cleanupRenderState(viewer)
    viewer.GlobeViewer.Controller.visualRequest('toggleAllRendering',...
    struct(...
    'EnableRendering',true,...
    'WaitForResponse',true,...
    'EnableWindowLaunch',true,...
    'Animation','none'));
end


