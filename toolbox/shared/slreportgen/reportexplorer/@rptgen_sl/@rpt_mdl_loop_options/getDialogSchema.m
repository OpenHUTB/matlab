function dlgStruct=getDialogSchema(this,name)





    if~builtin('license','checkout','SIMULINK_Report_Gen')
        dlgStruct=this.buildErrorMessage(name,true);
        return;
    end

    if isempty(this.MdlCurrSys)
        this.MdlCurrSys{1}='$top';
    end

    isTraverseDown=any(strcmp({'all','currentBelow'},this.SysLoopType));
    isSpecialMdlName=strncmp(this.MdlName,'$',1);


    wActive=this.dlgWidget('Active',...
    'DialogRefresh',true,...
    'RowSpan',[1,1],...
    'ColSpan',[1,2]);



    pMdlName=struct(findprop(classhandle(this),'MdlName'));
    pMdlName.DataType={
    '',''
    '$current',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:currentDiagramLabel'))
    '$all',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:allOpenModelsLabel'))
    '$alllib',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:allOpenLibrariesLabel'))
    '$pwd',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:diagramsInCurrentDirectoryLabel'))
    '$custom',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:customBlockDiagramLabel'))
    };

    [wModelName,tModelName]=this.dlgWidget(pMdlName,...
    'DialogRefresh',1,...
    'ForegroundColor',[1,1,255],...
    'Editable',1,...
    'Enabled',this.Active,...
    'RowSpan',[2,2],...
    'ColSpan',[2,2]);
    wModelFileBrowse=this.dlgFileBrowse('MdlName',...
    {'*.slx',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:simulinkModelFilesLabel'))},...
    'DialogRefresh',1,...
    'Enabled',this.Active,...
    'RowSpan',[2,2],...
    'ColSpan',[3,3]);


    [wTraverseModel,tTraverseModel]=this.dlgWidget('SysLoopType',...
    'DialogRefresh',true,...
    'Enabled',this.Active,...
    'RowSpan',[3,3],...
    'ColSpan',[2,3]);


    [wLookUnderMask,tLookUnderMask]=this.dlgWidget('isMask',...
    'Enabled',this.Active&&isTraverseDown,...
    'RowSpan',[4,4],...
    'ColSpan',[2,3]);


    [wFollowLibraryLinks,tFollowLibraryLinks]=this.dlgWidget('isLibrary',...
    'Enabled',this.Active&&isTraverseDown,...
    'RowSpan',[5,5],...
    'ColSpan',[2,3]);



    pModelReference=struct(findprop(classhandle(this),'ModelReferenceDepth'));
    pModelReference.DataType={
    '0',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:doNotFollowReferencesLabel'))
    'inf',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:followAllReferencesLabel'))
    '1',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:followReferencesInCurrentLabel'))
    '1',getString(message('RptgenSL:rsl_rpt_mdl_loop_options:customModelRefDepthLabel'))
    };
    [wModelReference,tModelReference]=this.dlgWidget(pModelReference,...
    'Editable',1,...
    'DialogRefresh',true,...
    'RowSpan',[6,6],...
    'ColSpan',[2,3]);


    wIncludeAllVariants=this.dlgWidget('IncludeAllVariants',...
    'Enabled',~strcmpi(this.ModelReferenceDepth,'0'),...
    'RowSpan',[7,7],...
    'ColSpan',[2,3]);



    currSysTop=getString(message('RptgenSL:rsl_rpt_mdl_loop_options:modelRootLabel'));
    currSysCurr=getString(message('RptgenSL:rsl_rpt_mdl_loop_options:currentSystemLabel'));
    pMdlCurrSys=struct(findprop(classhandle(this),'MdlCurrSys'));
    pMdlCurrSys.DataType={
    {'$current'},currSysCurr
    {'$top'},currSysTop
    };

    [wStartingSystem,tStartingSystem]=this.dlgWidget(pMdlCurrSys,...
    'Enabled',this.Active&&~strcmp(this.SysLoopType,'all'),...
    'Visible',isSpecialMdlName,...
    'RowSpan',[8,8],...
    'ColSpan',[2,3]);

    wStartingSystemEditArea=this.dlgWidgetStringVector('MdlCurrSys');
    wStartingSystemEditArea=this.dlgSet(wStartingSystemEditArea,...
    'Name','',...
    'Enabled',this.Active&&~strcmp(this.SysLoopType,'all'),...
    'Tag','MdlCurrSysEditarea',...
    'Visible',~isSpecialMdlName,...
    'RowSpan',[8,9],...
    'ColSpan',[2,3]);


    dlgStruct=this.dlgMain(name,{
wActive
tModelName
wModelName
wModelFileBrowse
tTraverseModel
wTraverseModel
tLookUnderMask
wLookUnderMask
tFollowLibraryLinks
wFollowLibraryLinks
wModelReference
tModelReference
wIncludeAllVariants
wStartingSystem
tStartingSystem
wStartingSystemEditArea
    },...
    'LayoutGrid',[9,2],...
    'RowStretch',[0,0,0,0,0,0,0,0,1],...
    'ColStretch',[1,0]);

    if strcmpi(name,'panel')
        dlgStruct.Name=getString(message('RptgenSL:rsl_rpt_mdl_loop_options:modelOptionsLabel'));
        dlgStruct.Type='group';
    end
