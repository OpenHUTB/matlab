function varargout=radiationpattern2D(MagE1,theta1,phi1,frequency,slice,varargin)









    if nargin>5
        SliceValue=varargin{1};
    else
        SliceValue=[];
    end

    [MagEnew,xvalnew,~,str]=antennashared.internal.radpattern2Ddata(MagE1,phi1,...
    theta1,frequency,slice,SliceValue);

    if numel(xvalnew)==1
        xvalnew(2:3,1)=xvalnew(1,1);
        MagEnew(2:3,1)=MagEnew(1,1);
    end

    hfig=gcf;
    if~isempty(get(groot,'CurrentFigure'))
        clf(hfig);
    end
    P=polarpattern(xvalnew(:,1),MagEnew,'DrawGridToOrigin',1,...
    'LineWidth',2,'GridWidth',1.5,'AngleResolution',30,'Peaks',1);
    if strcmpi(str.unit,'deg')
        createLabels(P,'%s=%d#deg',str.type,str.value);
    else
        createLabels(P,'%s=%d %s',str.type,str.value,str.unit);
    end
    P.TitleTopOffset=0.12;























    if nargout==1
        varargout{1}=P;
    end




    try
        set(hfig,'NextPlot','replace');
        if antennashared.internal.figureForwardState(hfig)
            shg;
        end
    catch
    end

end


















































































































































































































































































































































































































































































