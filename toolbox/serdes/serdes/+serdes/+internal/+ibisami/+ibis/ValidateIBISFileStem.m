function errorMsg=ValidateIBISFileStem(testString,ver6)



...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...









    if nargin<2
        ver6=true;
    end
    errorMsg=[];
    testString=char(testString);
    if isempty(testString)
        errorMsg=message('serdes:ibis:CannotBeEmpty').getString;
        return
    end
    if ver6
        legalChars=['abcdefghijklmnopqrstuvwxyz',...
        '0123456789_^$~!#%&-{})(@`''.'];
        legalLength=40;
    else
        legalChars=['abcdefghijklmnopqrstuvwxyz',...
        'ABCDEFGHIJKLMNOPQRSTUVWXYZ',...
        '0123456789_^$~!#%&-{})(@`''.'];
        legalLength=60;
    end
    if~all(ismember(testString,legalChars))
        errorMsg=message('serdes:ibis:MustBeOneOfCharacters',legalChars).getString;
        return
    end
    if numel(testString)>legalLength
        errorMsg=message('serdes:ibis:CannotExceed',legalLength).getString;
        return
    end
end

