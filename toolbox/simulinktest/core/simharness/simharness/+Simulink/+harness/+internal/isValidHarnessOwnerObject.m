function res=isValidHarnessOwnerObject(selection)




    res=false;
    if((isa(selection,'Simulink.SubSystem')&&...
        strcmpi(get_param(get(selection,'Handle'),'SimulinkSubDomain'),'Simulink'))||...
        isa(selection,'Simulink.ModelReference')||...
        isa(selection,'Simulink.SFunction')||...
        isa(selection,'Simulink.MSFunction')||...
        isa(selection,'Simulink.MATLABSystem')||...
        isa(selection,'Simulink.FMU')||...
        (slfeature('CustomCodeIntegrationHarness')&&isa(selection,'Simulink.CCaller'))||...
        (slfeature('CFunctionBlockHarness')&&isa(selection,'Simulink.CFunction'))||...
        (slfeature('SimscapeBlockHarness')&&isa(selection,'Simulink.SimscapeBlock')))


        res=~Simulink.harness.internal.blockIsInsideSSMdlOrRef(selection.Handle);

    elseif(isa(selection,'Simulink.SubSystem')||isa(selection,'Simulink.BlockDiagram'))&&...
        any(strcmpi(get_param(get(selection,'Handle'),'SimulinkSubDomain'),...
        {'Architecture','SoftwareArchitecture','AUTOSARArchitecture'}))
        res=true;




        if isa(selection,'Simulink.SubSystem')&&...
            (Simulink.internal.isArchitectureModel(bdroot(get(selection,'Handle')),'SoftwareArchitecture')||...
            Simulink.internal.isArchitectureModel(bdroot(get(selection,'Handle')),'AUTOSARArchitecture'))&&...
            isequal(slfeature('TestHarnessInlineComps'),0)
            results=find_system(Simulink.ID.getFullName(selection.handle),'MatchFilter',@isModelReferenceInSoftwareOrAUTOSARDomain);
            if~isempty(results)
                res=false;
            end
        end
    end
end

function tf=isModelReferenceInSoftwareOrAUTOSARDomain(h)

    tf=false;
    if strcmp(get_param(h,'BlockType'),'ModelReference')&&(strcmp(get_param(get_param(h,'Parent'),'SimulinkSubDomain'),'SoftwareArchitecture')||...
        strcmp(get_param(get_param(h,'Parent'),'SimulinkSubDomain'),'AUTOSARArchitecture'))
        tf=true;
    end
end
