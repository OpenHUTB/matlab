

function DataCounterAndValidDecoder(~,hN,CntVldDecoderInSigs,CntVldDecoderOutSigs,...
    hBoolT,hCounterT,slRate,blockInfo)


    hCntVldDecoderN=pirelab.createNewNetwork(...
    'Name','DataCounterAndValidDecoder',...
    'InportNames',{'startPulse','rowCountEn','colCountEn','valid','fwdSubDone'},...
    'InportTypes',[hBoolT,hBoolT,hBoolT,hBoolT,hBoolT],...
    'InportRates',slRate*ones(1,5),...
    'OutportNames',{'rowCount','colCountReg','diagonalEn','nonDiagonalEn','colCount'},...
    'OutportTypes',[hCounterT,hCounterT,hBoolT,hBoolT,hCounterT]);

    hCntVldDecoderN.setTargetCompReplacementCandidate(true);


    for ii=1:numel(hCntVldDecoderN.PirOutputSignals)
        hCntVldDecoderN.PirOutputSignals(ii).SimulinkRate=slRate;
    end

    hCntVldDecoderNinSigs=hCntVldDecoderN.PirInputSignals;
    hCntVldDecoderNoutSigs=hCntVldDecoderN.PirOutputSignals;


    if(blockInfo.RowSize>1)
        hColCounterT=hCntVldDecoderN.getType('FixedPoint','Signed',false,'WordLength',...
        ceil(log2(blockInfo.RowSize))+1,'FractionLength',0);
    else
        hColCounterT=hCntVldDecoderN.getType('FixedPoint','Signed',false,'WordLength',...
        ceil(log2(blockInfo.RowSize))+2,'FractionLength',0);
    end


    Delay2_out1_s4=l_addSignal(hCntVldDecoderN,'Delay2_out1',hBoolT,slRate);
    LogicalOperator_out1_s5=l_addSignal(hCntVldDecoderN,sprintf('Logical\nOperator_out1'),hBoolT,slRate);
    LogicalOperator5_out1_s6=l_addSignal(hCntVldDecoderN,sprintf('Logical\nOperator5_out1'),hBoolT,slRate);
    LogicalOperator6_out1_s7=l_addSignal(hCntVldDecoderN,sprintf('Logical\nOperator6_out1'),hBoolT,slRate);
    rowColCompare_out1_s12=l_addSignal(hCntVldDecoderN,'rowColCompare_out1',hBoolT,slRate);
    rowCounter_out1_s14=l_addSignal(hCntVldDecoderN,'rowCounter_out1',hCounterT,slRate);

    colCountS=l_addSignal(hCntVldDecoderN,'colCount',hColCounterT,slRate);
    rowCountTypeChangeS=l_addSignal(hCntVldDecoderN,'rowCountTypeChange',hColCounterT,slRate);
    LogicalOperatorRstOutS=l_addSignal(hCntVldDecoderN,'LogicalOperatorRstOut',hBoolT,slRate);

    pirelab.getIntDelayComp(hCntVldDecoderN,...
    hCntVldDecoderNinSigs(2),...
    Delay2_out1_s4,...
    1,'Delay2',...
    false,...
    0,0,[],0,0);


    pirelab.getIntDelayComp(hCntVldDecoderN,...
    hCntVldDecoderNoutSigs(5),...
    hCntVldDecoderNoutSigs(2),...
    1,'colCountReg',...
    0,...
    0,0,[],0,0);


    pirelab.getCounterComp(hCntVldDecoderN,...
    [hCntVldDecoderNinSigs(5),Delay2_out1_s4,rowCountTypeChangeS,hCntVldDecoderNinSigs(3)],...
    colCountS,...
    'Count limited',1,-1,blockInfo.RowSize+1,1,1,1,0,'colCounter',1);

    pirelab.getDTCComp(hCntVldDecoderN,...
    colCountS,...
    hCntVldDecoderNoutSigs(5),...
    'Floor','Wrap','RWV','Data Type Conversion');


    pirelab.getIntDelayComp(hCntVldDecoderN,...
    LogicalOperator_out1_s5,...
    hCntVldDecoderNoutSigs(3),...
    1,'diagonalValidReg',...
    false,...
    0,0,[],0,0);


    pirelab.getIntDelayComp(hCntVldDecoderN,...
    LogicalOperator6_out1_s7,...
    hCntVldDecoderNoutSigs(4),...
    1,'nonDiagonalValid',...
    false,...
    0,0,[],0,0);


    pirelab.getIntDelayComp(hCntVldDecoderN,...
    rowCounter_out1_s14,...
    hCntVldDecoderNoutSigs(1),...
    1,'rowCountReg',...
    0,...
    0,0,[],0,0);

    pirelab.getLogicComp(hCntVldDecoderN,...
    [hCntVldDecoderNinSigs(1),hCntVldDecoderNinSigs(5)],...
    LogicalOperatorRstOutS,...
    'or',sprintf('LogicalOperatorRstOut'));


    pirelab.getCounterComp(hCntVldDecoderN,...
    [LogicalOperatorRstOutS,hCntVldDecoderNinSigs(2)],...
    rowCounter_out1_s14,...
    'Count limited',1,1,blockInfo.RowSize,1,0,1,0,'rowCounter',1);


    pirelab.getDTCComp(hCntVldDecoderN,...
    rowCounter_out1_s14,...
    rowCountTypeChangeS,...
    'Floor','Wrap','RWV','Data Type Conversion');




    pirelab.getLogicComp(hCntVldDecoderN,...
    [rowColCompare_out1_s12,hCntVldDecoderNinSigs(4)],...
    LogicalOperator_out1_s5,...
    'and',sprintf('Logical\nOperator'));


    pirelab.getLogicComp(hCntVldDecoderN,...
    rowColCompare_out1_s12,...
    LogicalOperator5_out1_s6,...
    'not',sprintf('Logical\nOperator5'));


    pirelab.getLogicComp(hCntVldDecoderN,...
    [LogicalOperator5_out1_s6,hCntVldDecoderNinSigs(4)],...
    LogicalOperator6_out1_s7,...
    'and',sprintf('Logical\nOperator6'));


    pirelab.getRelOpComp(hCntVldDecoderN,...
    [rowCounter_out1_s14,hCntVldDecoderNoutSigs(5)],...
    rowColCompare_out1_s12,...
    '==',0,'rowColCompare');

    pirelab.instantiateNetwork(hN,hCntVldDecoderN,CntVldDecoderInSigs,CntVldDecoderOutSigs,...
    [hCntVldDecoderN.Name,'_inst']);

end


function hS=l_addSignal(hN,sigName,pirTyp,simulinkRate)
    hS=hN.addSignal;
    hS.Name=sigName;
    hS.Type=pirTyp;
    hS.SimulinkHandle=-1;
    hS.SimulinkRate=simulinkRate;
end


