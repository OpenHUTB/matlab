
function NonDiagCounter(~,hN,NonDiagCounterInSigs,NonDiagCounterOutSigs,...
    hBoolT,hAddrT,slRate,blockInfo)


    hNonDiagCounterN=pirelab.createNewNetwork(...
    'Name','NonDiagCounter',...
    'InportNames',{'rowDone','nonDiagCountValid'},...
    'InportTypes',[hBoolT,hBoolT],...
    'InportRates',slRate*ones(1,2),...
    'OutportNames',{'nonDiagCount'},...
    'OutportTypes',hAddrT);

    hNonDiagCounterN.setTargetCompReplacementCandidate(true);


    for ii=1:numel(hNonDiagCounterN.PirOutputSignals)
        hNonDiagCounterN.PirOutputSignals(ii).SimulinkRate=slRate;
    end

    hNonDiagCounterNinSigs=hNonDiagCounterN.PirInputSignals;
    hNonDiagCounterNoutSigs=hNonDiagCounterN.PirOutputSignals;

    nonDiagCountOutS=l_addSignal(hNonDiagCounterN,'nonDiagCountOut',hAddrT,slRate);

    pirelab.getCounterComp(hNonDiagCounterN,...
    [hNonDiagCounterNinSigs(1),hNonDiagCounterNinSigs(2)],...
    nonDiagCountOutS,...
    'Count limited',1,1,blockInfo.RowSize-1,1,0,1,0,'HDL Counter',1);

    pirelab.getIntDelayComp(hNonDiagCounterN,...
    nonDiagCountOutS,...
    hNonDiagCounterNoutSigs(1),...
    0,'Delay',...
    0,...
    0,0,[],0,0);


    pirelab.instantiateNetwork(hN,hNonDiagCounterN,NonDiagCounterInSigs,...
    NonDiagCounterOutSigs,[hNonDiagCounterN.Name,'_inst']);

end

function hS=l_addSignal(hN,sigName,pirTyp,simulinkRate)
    hS=hN.addSignal;
    hS.Name=sigName;
    hS.Type=pirTyp;
    hS.SimulinkHandle=-1;
    hS.SimulinkRate=simulinkRate;
end
