

function OutputStreamControllerGaussJordan(~,hN,OutControlInSigs,OutControlOutSigs,hBoolT,...
    hInputDataT,hAddrT,hCounterT,slRate,blockInfo)





    hOutControlN=pirelab.createNewNetwork(...
    'Name','OutputStreamControllerGaussJordan',...
    'InportNames',{'invFinish','outEnable','rdData'},...
    'InportTypes',[hBoolT,hBoolT,pirelab.createPirArrayType(hInputDataT,[blockInfo.MatrixSize*2,0])],...
    'InportRates',slRate*ones(1,3),...
    'OutportNames',{'outStreamEnb','validOut','dataOut','rdAddrOut','outStreamDone'},...
    'OutportTypes',[hBoolT,hBoolT,hInputDataT,hAddrT,hBoolT]);

    hOutControlN.setTargetCompReplacementCandidate(true);

    for ii=1:numel(hOutControlN.PirOutputSignals)
        hOutControlN.PirOutputSignals(ii).SimulinkRate=slRate;
    end

    hOutControlNinSigs=hOutControlN.PirInputSignals;
    hOutControlNoutSigs=hOutControlN.PirOutputSignals;

    outStreamRdEnbS=l_addSignal(hOutControlN,'outStreamRdEnb',hBoolT,slRate);
    rowCountS=l_addSignal(hOutControlN,'rowCount',hCounterT,slRate);


    RdControlInSigs=[hOutControlNinSigs(1),hOutControlNoutSigs(5)];
    RdControlOutSigs=[hOutControlNoutSigs(1),outStreamRdEnbS,rowCountS,hOutControlNoutSigs(4)];

    ReadControlGaussJordan(hOutControlN,RdControlInSigs,RdControlOutSigs,hBoolT,hCounterT,hAddrT,slRate,blockInfo);


    OutDataSelInSigs=[hOutControlNoutSigs(1),outStreamRdEnbS,rowCountS,...
    hOutControlNinSigs(2),hOutControlNinSigs(3)];

    OutDataSelOutSigs=[hOutControlNoutSigs(2),hOutControlNoutSigs(3)];

    OutDataSelectorGaussJordan(hOutControlN,OutDataSelInSigs,OutDataSelOutSigs,hBoolT,hCounterT,hInputDataT,slRate,blockInfo);


    OutDoneInSigs=hOutControlNoutSigs(1);
    OutDoneOutSigs=hOutControlNoutSigs(5);

    OutStreamDoneGeneratorGaussJordan(hOutControlN,OutDoneInSigs,OutDoneOutSigs,hBoolT,slRate);


    pirelab.instantiateNetwork(hN,hOutControlN,OutControlInSigs,OutControlOutSigs,...
    [hOutControlN.Name,'_inst']);
end



function ReadControlGaussJordan(hN,RdControlInSigs,RdControlOutSigs,hBoolT,hCounterT,hAddrT,slRate,blockInfo)




    hReadControlGaussJordanN=pirelab.createNewNetwork(...
    'Name','ReadControlGaussJordan',...
    'InportNames',{'invFinish','outStreamDone'},...
    'InportTypes',[hBoolT,hBoolT],...
    'InportRates',slRate*ones(1,2),...
    'OutportNames',{'outStreamEnable','outStreamRdEnable','colCount','rdAddrOut'},...
    'OutportTypes',[hBoolT,hBoolT,hCounterT,hAddrT]);


    for ii=1:numel(hReadControlGaussJordanN.PirOutputSignals)
        hReadControlGaussJordanN.PirOutputSignals(ii).SimulinkRate=slRate;
    end
    hReadControlGaussJordanNinSigs=hReadControlGaussJordanN.PirInputSignals;
    hReadControlGaussJordanNoutSigs=hReadControlGaussJordanN.PirOutputSignals;

    CompareToConstant_out1_s1=l_addSignal(hReadControlGaussJordanN,sprintf('Compare\nTo Constant_out1'),hBoolT,slRate);
    CompareToConstant2_out1_s2=l_addSignal(hReadControlGaussJordanN,sprintf('Compare\nTo Constant2_out1'),hBoolT,slRate);
    Constant_out1_s3=l_addSignal(hReadControlGaussJordanN,'Constant_out1',hBoolT,slRate);
    Constant1_out1_s4=l_addSignal(hReadControlGaussJordanN,'Constant1_out1',hBoolT,slRate);
    Constant2_out1_s5=l_addSignal(hReadControlGaussJordanN,'Constant2_out1',hCounterT,slRate);
    Delay_out1_s6=l_addSignal(hReadControlGaussJordanN,'Delay_out1',hBoolT,slRate);
    HDLCounter_out1_s8=l_addSignal(hReadControlGaussJordanN,'HDL Counter_out1',hCounterT,slRate);
    LogicalOperator_out1_s10=l_addSignal(hReadControlGaussJordanN,sprintf('Logical\nOperator_out1'),hBoolT,slRate);
    LogicalOperator2_out1_s12=l_addSignal(hReadControlGaussJordanN,sprintf('Logical\nOperator2_out1'),hBoolT,slRate);
    LogicalOperator3_out1_s13=l_addSignal(hReadControlGaussJordanN,sprintf('Logical\nOperator3_out1'),hBoolT,slRate);
    Switch_out1_s15=l_addSignal(hReadControlGaussJordanN,'Switch_out1',hBoolT,slRate);
    Switch1_out1_s16=l_addSignal(hReadControlGaussJordanN,'Switch1_out1',hBoolT,slRate);



    pirelab.getConstComp(hReadControlGaussJordanN,...
    Constant_out1_s3,...
    1,...
    'Constant','on',0,'','','');

    pirelab.getConstComp(hReadControlGaussJordanN,...
    Constant1_out1_s4,...
    0,...
    'Constant1','on',1,'','','');

    pirelab.getConstComp(hReadControlGaussJordanN,...
    Constant2_out1_s5,...
    1,...
    'Constant2','on',0,'','','');

    pirelab.getIntDelayComp(hReadControlGaussJordanN,...
    hReadControlGaussJordanNoutSigs(2),...
    Delay_out1_s6,...
    1,'Delay',...
    false,...
    0,0,[],0,0);

    pirelab.getIntDelayComp(hReadControlGaussJordanN,...
    Switch_out1_s15,...
    hReadControlGaussJordanNoutSigs(2),...
    1,'Delay1',...
    false,...
    0,0,[],0,0);


    pirelab.getCounterComp(hReadControlGaussJordanN,...
    [hReadControlGaussJordanNinSigs(2),hReadControlGaussJordanNoutSigs(2)],...
    hReadControlGaussJordanNoutSigs(3),...
    'Count limited',1,1,blockInfo.MatrixSize,1,0,1,0,'HDL Counter',1);

    pirelab.getCounterComp(hReadControlGaussJordanN,...
    [hReadControlGaussJordanNinSigs(2),LogicalOperator_out1_s10],...
    HDLCounter_out1_s8,...
    'Count limited',1,1,blockInfo.MatrixSize,1,0,1,0,'HDL Counter1',1);

    pirelab.getCompareToValueComp(hReadControlGaussJordanN,...
    hReadControlGaussJordanNoutSigs(3),...
    CompareToConstant_out1_s1,...
    '==',blockInfo.MatrixSize,...
    sprintf('Compare\nTo Constant'),0);

    pirelab.getCompareToValueComp(hReadControlGaussJordanN,...
    HDLCounter_out1_s8,...
    CompareToConstant2_out1_s2,...
    '==',blockInfo.MatrixSize,...
    sprintf('Compare\nTo Constant2'),0);

    pirelab.getLogicComp(hReadControlGaussJordanN,...
    [hReadControlGaussJordanNoutSigs(2),CompareToConstant_out1_s1],...
    LogicalOperator_out1_s10,...
    'and',sprintf('Logical\nOperator'));

    pirelab.getLogicComp(hReadControlGaussJordanN,...
    [Delay_out1_s6,hReadControlGaussJordanNoutSigs(2)],...
    hReadControlGaussJordanNoutSigs(1),...
    'or',sprintf('Logical\nOperator1'));


    pirelab.getLogicComp(hReadControlGaussJordanN,...
    [CompareToConstant2_out1_s2,CompareToConstant_out1_s1],...
    LogicalOperator2_out1_s12,...
    'and',sprintf('Logical\nOperator2'));

    pirelab.getLogicComp(hReadControlGaussJordanN,...
    [hReadControlGaussJordanNoutSigs(2),LogicalOperator2_out1_s12],...
    LogicalOperator3_out1_s13,...
    'and',sprintf('Logical\nOperator3'));

    pirelab.getAddComp(hReadControlGaussJordanN,...
    [HDLCounter_out1_s8,Constant2_out1_s5],...
    hReadControlGaussJordanNoutSigs(4),...
    'Floor','Wrap','Subtract3',hCounterT,'+-');

    pirelab.getSwitchComp(hReadControlGaussJordanN,...
    [Constant_out1_s3,Switch1_out1_s16],...
    Switch_out1_s15,...
    hReadControlGaussJordanNinSigs(1),'Switch',...
    '~=',0,'Floor','Wrap');

    pirelab.getSwitchComp(hReadControlGaussJordanN,...
    [Constant1_out1_s4,hReadControlGaussJordanNoutSigs(2)],...
    Switch1_out1_s16,...
    LogicalOperator3_out1_s13,'Switch1',...
    '~=',0,'Floor','Wrap');



    pirelab.instantiateNetwork(hN,hReadControlGaussJordanN,RdControlInSigs,RdControlOutSigs,...
    [hReadControlGaussJordanN.Name,'_inst']);
end



function OutDataSelectorGaussJordan(hN,OutDataSelInSigs,OutDataSelOutSigs,hBoolT,...
    hCounterT,hInputDataT,slRate,blockInfo)




    hOutDataSelN=pirelab.createNewNetwork(...
    'Name','OutDataSelectorGaussJordan',...
    'InportNames',{'outStreamEnable','outStreamRdEnable','colCount',...
    'outEnable','rdData'},...
    'InportTypes',[hBoolT,hBoolT,hCounterT,hBoolT,pirelab.createPirArrayType(hInputDataT,[blockInfo.MatrixSize*2,0])],...
    'InportRates',slRate*ones(1,5),...
    'OutportNames',{'validOut','dataOut'},...
    'OutportTypes',[hBoolT,hInputDataT]);


    for ii=1:numel(hOutDataSelN.PirOutputSignals)
        hOutDataSelN.PirOutputSignals(ii).SimulinkRate=slRate;
    end
    hOutDataSelNinSigs=hOutDataSelN.PirInputSignals;
    hOutDataSelNoutSigs=hOutDataSelN.PirOutputSignals;

    outStreamEnable=hOutDataSelNinSigs(1);
    outStreamRdEnable=hOutDataSelNinSigs(2);
    rowCount=hOutDataSelNinSigs(3);
    outEnable=hOutDataSelNinSigs(4);
    rdData=hOutDataSelNinSigs(5);

    validOut=hOutDataSelNoutSigs(1);
    dataOut=hOutDataSelNoutSigs(2);


    pirTyp1=pir_boolean_t;
    pirTyp3=OutDataSelInSigs(5).Type.BaseType;
    pirTyp2=pir_ufixpt_t(ceil(log2(blockInfo.MatrixSize))+1,0);
    pirTyp4=pir_unsigned_t(8);

    if blockInfo.MatrixSize==1
        hArrayT=pirTyp3;
    else
        hArrayT=pirelab.createPirArrayType(pirTyp3,[blockInfo.MatrixSize,0]);
    end


    Constant2_out1_s5=l_addSignal(hOutDataSelN,'Constant2_out1',pirTyp3,slRate);
    DataTypeConversion_out1_s6=l_addSignal(hOutDataSelN,'Data Type Conversion_out1',pirTyp4,slRate);
    Delay_out1_s7=l_addSignal(hOutDataSelN,'Delay_out1',pirTyp2,slRate);
    Delay1_out1_s8=l_addSignal(hOutDataSelN,'Delay1_out1',pirTyp1,slRate);
    LogicalOperator8_out1_s10=l_addSignal(hOutDataSelN,sprintf('Logical\nOperator8_out1'),pirTyp1,slRate);
    LogicalOperatorOutS=l_addSignal(hOutDataSelN,sprintf('LogicalOperatorOut'),pirTyp1,slRate);
    Selector_out1_s11=l_addSignal(hOutDataSelN,'Selector_out1',hArrayT,slRate);
    Selector1_out1_s12=l_addSignal(hOutDataSelN,'Selector1_out1',pirTyp3,slRate);
    Delay_out_s14=l_addSignal(hOutDataSelN,'Delay_out',pirTyp2,slRate);
    Delay_Initial_Val_out_s15=l_addSignal(hOutDataSelN,'Delay_Initial_Val_out',pirTyp2,slRate);
    Delay_ctrl_const_out_s16=l_addSignal(hOutDataSelN,'Delay_ctrl_const_out',pirTyp1,slRate);
    Delay_ctrl_delay_out_s17=l_addSignal(hOutDataSelN,'Delay_ctrl_delay_out',pirTyp1,slRate);

    pirelab.getConstComp(hOutDataSelN,...
    Constant2_out1_s5,...
    0,...
    'Constant2','on',1,'','','');


    pirelab.getIntDelayComp(hOutDataSelN,...
    rowCount,...
    Delay_out_s14,...
    1,'Delay',...
    double(0),...
    0,0,[],0,0);


    pirelab.getIntDelayComp(hOutDataSelN,...
    outStreamRdEnable,...
    Delay1_out1_s8,...
    1,'Delay1',...
    false,...
    0,0,[],0,0);


    pirelab.getConstComp(hOutDataSelN,...
    Delay_Initial_Val_out_s15,...
    1,...
    'Delay_Initial_Val','on',0,'','','');

    pirelab.getConstComp(hOutDataSelN,...
    Delay_ctrl_const_out_s16,...
    1,...
    'Delay_ctrl_const');

    pirelab.getIntDelayComp(hOutDataSelN,...
    Delay_ctrl_const_out_s16,...
    Delay_ctrl_delay_out_s17,...
    1,'Delay_ctrl_delay',...
    0,...
    0,0,[],0,0);

    pirelab.getSwitchComp(hOutDataSelN,...
    [Delay_out_s14,Delay_Initial_Val_out_s15],...
    Delay_out1_s7,...
    Delay_ctrl_delay_out_s17,'Delay_switch',...
    '~=',0,'Floor','Wrap');


    pirelab.getDTCComp(hOutDataSelN,...
    Delay_out1_s7,...
    DataTypeConversion_out1_s6,...
    'Floor','Wrap','RWV','Data Type Conversion');


    pirelab.getLogicComp(hOutDataSelN,...
    [outEnable,Delay1_out1_s8],...
    validOut,...
    'and',sprintf('Logical\nOperator'));



    pirelab.getLogicComp(hOutDataSelN,...
    [outEnable,outStreamEnable],...
    LogicalOperator8_out1_s10,...
    'and',sprintf('Logical\nOperator8'));

    pirelab.getLogicComp(hOutDataSelN,...
    [LogicalOperator8_out1_s10,validOut],...
    LogicalOperatorOutS,...
    'and',sprintf('Logical\nOperator8'));


    pirelab.getSelectorComp(hOutDataSelN,...
    rdData,...
    Selector_out1_s11,...
    'One-based',{'Index vector (dialog)'},...
    {blockInfo.MatrixSize+1:blockInfo.MatrixSize*2},...
    {'1'},'1',...
    'Selector');

    if blockInfo.MatrixSize==1
        pirelab.getWireComp(hOutDataSelN,Selector_out1_s11,Selector1_out1_s12,'SelectorOut1');
    else
        pirelab.getSelectorComp(hOutDataSelN,...
        [Selector_out1_s11,DataTypeConversion_out1_s6],...
        Selector1_out1_s12,...
        'One-based',{'Index vector (port)'},...
        {1:3},...
        {'1'},'1',...
        'Selector1');
    end

    pirelab.getSwitchComp(hOutDataSelN,...
    [Selector1_out1_s12,Constant2_out1_s5],...
    dataOut,...
    LogicalOperatorOutS,'Switch',...
    '~=',0,'Floor','Wrap');





    pirelab.instantiateNetwork(hN,hOutDataSelN,OutDataSelInSigs,OutDataSelOutSigs,...
    [hOutDataSelN.Name,'_inst']);

end


function OutStreamDoneGeneratorGaussJordan(hN,OutDoneInSigs,OutDoneOutSigs,hBoolT,...
    slRate)




    hOutDoneN=pirelab.createNewNetwork(...
    'Name','OutStreamDoneGeneratorGaussJordan',...
    'InportNames',{'outStreamEnable'},...
    'InportTypes',hBoolT,...
    'InportRates',slRate,...
    'OutportNames',{'outStreamDone'},...
    'OutportTypes',hBoolT);


    for ii=1:numel(hOutDoneN.PirOutputSignals)
        hOutDoneN.PirOutputSignals(ii).SimulinkRate=slRate;
    end

    hOutDoneNinSigs=hOutDoneN.PirInputSignals;
    hOutDoneNoutSigs=hOutDoneN.PirOutputSignals;



    CompareToConstant8_out1_s1=l_addSignal(hOutDoneN,sprintf('Compare\nTo Constant8_out1'),hBoolT,slRate);
    CompareToConstant9_out1_s2=l_addSignal(hOutDoneN,sprintf('Compare\nTo Constant9_out1'),hBoolT,slRate);
    Delay3_out1_s3=l_addSignal(hOutDoneN,'Delay3_out1',hBoolT,slRate);
    Delay3_out_s5=l_addSignal(hOutDoneN,'Delay3_out',hBoolT,slRate);
    Delay3_Initial_Val_out_s6=l_addSignal(hOutDoneN,'Delay3_Initial_Val_out',hBoolT,slRate);
    Delay3_ctrl_const_out_s7=l_addSignal(hOutDoneN,'Delay3_ctrl_const_out',hBoolT,slRate);
    Delay3_ctrl_delay_out_s8=l_addSignal(hOutDoneN,'Delay3_ctrl_delay_out',hBoolT,slRate);

    pirelab.getIntDelayComp(hOutDoneN,...
    hOutDoneNinSigs(1),...
    Delay3_out_s5,...
    1,'Delay3',...
    double(0),...
    0,0,[],0,0);


    pirelab.getConstComp(hOutDoneN,...
    Delay3_Initial_Val_out_s6,...
    false,...
    'Delay3_Initial_Val','on',0,'','','');

    pirelab.getConstComp(hOutDoneN,...
    Delay3_ctrl_const_out_s7,...
    1,...
    'Delay3_ctrl_const');

    pirelab.getIntDelayComp(hOutDoneN,...
    Delay3_ctrl_const_out_s7,...
    Delay3_ctrl_delay_out_s8,...
    1,'Delay3_ctrl_delay',...
    0,...
    0,0,[],0,0);

    pirelab.getSwitchComp(hOutDoneN,...
    [Delay3_out_s5,Delay3_Initial_Val_out_s6],...
    Delay3_out1_s3,...
    Delay3_ctrl_delay_out_s8,'Delay3_switch',...
    '~=',0,'Floor','Wrap');


    pirelab.getCompareToValueComp(hOutDoneN,...
    Delay3_out1_s3,...
    CompareToConstant8_out1_s1,...
    '==',1,...
    sprintf('Compare\nTo Constant8'),0);


    pirelab.getCompareToValueComp(hOutDoneN,...
    hOutDoneNinSigs(1),...
    CompareToConstant9_out1_s2,...
    '==',0,...
    sprintf('Compare\nTo Constant9'),1);


    pirelab.getLogicComp(hOutDoneN,...
    [CompareToConstant9_out1_s2,CompareToConstant8_out1_s1],...
    hOutDoneNoutSigs(1),...
    'and',sprintf('Logical\nOperator4'));



    pirelab.instantiateNetwork(hN,hOutDoneN,OutDoneInSigs,OutDoneOutSigs,...
    [hOutDoneN.Name,'_inst']);
end


function hS=l_addSignal(hN,sigName,pirTyp,simulinkRate)
    hS=hN.addSignal;
    hS.Name=sigName;
    hS.Type=pirTyp;
    hS.SimulinkHandle=-1;
    hS.SimulinkRate=simulinkRate;
end


