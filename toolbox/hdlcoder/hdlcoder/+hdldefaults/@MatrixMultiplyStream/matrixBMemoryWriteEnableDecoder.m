function hBWEDN=matrixBMemoryWriteEnableDecoder(~,hBMemCtlN,hInSigs,hOutSigs,slRate,blockInfo)



    hBoolT=pir_boolean_t;
    inputDataT=hInSigs(1).Type;
    bRow=blockInfo.aColumnSize;
    hbRowCounterT=pir_fixpt_t(false,ceil(log2(blockInfo.aColumnSize))+1,0);
    hbColCounterT=pir_fixpt_t(false,ceil(log2(blockInfo.bColumnSize))+1,0);


    if(blockInfo.aColumnSize~=1)
        hbRowSizeArrayT=hBMemCtlN.getType('Array','BaseType',inputDataT,'Dimensions',bRow);
        hbRowSizeBoolT=hBMemCtlN.getType('Array','BaseType',hBoolT,'Dimensions',bRow);
        hbRowSizeArrayColCounT=hBMemCtlN.getType('Array','BaseType',hbColCounterT,'Dimensions',bRow);
    else

        hbRowSizeArrayT=hInSigs(1).Type;
        hbRowSizeBoolT=hInSigs(3).Type;
        hbRowSizeArrayColCounT=hbColCounterT;
    end

    hBWEDN=pirelab.createNewNetwork(...
    'Name','matrixBMemoryWriteEnableDecoder',...
    'InportNames',{'bWrData','bWrAddr','bWrEn','bRowCount'},...
    'InportTypes',[inputDataT,hbColCounterT,hBoolT,hbRowCounterT],...
    'InportRates',slRate*ones(1,4),...
    'OutportNames',{'wrEn','wrAddr','wrData'},...
    'OutportTypes',[hbRowSizeBoolT,hbRowSizeArrayColCounT,hbRowSizeArrayT]);
    hBWEDN.setTargetCompReplacementCandidate(true);
    for ii=1:numel(hBWEDN.PirOutputSignals)
        hBWEDN.PirOutputSignals(ii).SimulinkRate=slRate;
    end

    pirelab.instantiateNetwork(hBMemCtlN,hBWEDN,hInSigs,hOutSigs,...
    [hBWEDN.Name,'_inst']);

    bWrDataS=hBWEDN.PirInputSignals(1);
    bWrAddrS=hBWEDN.PirInputSignals(2);
    bWrEnS=hBWEDN.PirInputSignals(3);
    bRowCountS=hBWEDN.PirInputSignals(4);
    wrEnS=hBWEDN.PirOutputSignals(1);
    wrAddrS=hBWEDN.PirOutputSignals(2);
    wrDataS=hBWEDN.PirOutputSignals(3);

    constantS=l_addSignal(hBWEDN,'logicalZeroFlagS',hBoolT,slRate);
    if(blockInfo.aColumnSize~=1)
        wrEnTempS=hdlhandles(1,bRow);
        wrAddrTempS=hdlhandles(1,bRow);
        wrDataTempS=hdlhandles(1,bRow);
        compareToConstantS=hdlhandles(1,bRow);
        pirelab.getConstComp(hBWEDN,...
        constantS,...
        0,...
        'Constant','on',1,'','','');

        for i=1:bRow
            suffix=['_',int2str(i-1)];
            wrEnTempS(i)=l_addSignal(hBWEDN,['wrEnTemp',suffix],hBoolT,slRate);
            wrAddrTempS(i)=l_addSignal(hBWEDN,['wrAddrTempS',suffix],hbColCounterT,slRate);
            wrDataTempS(i)=l_addSignal(hBWEDN,['wrDataTempS',suffix],inputDataT,slRate);
            compareToConstantS(i)=l_addSignal(hBWEDN,['compareToConstant',suffix],hBoolT,slRate);
            pirelab.getCompareToValueComp(hBWEDN,...
            bRowCountS,...
            compareToConstantS(i),...
            '==',i,...
            ['compareToConstant',suffix],0);

            pirelab.getSwitchComp(hBWEDN,...
            [bWrEnS,constantS],...
            wrEnTempS(i),...
            compareToConstantS(i),['switch',suffix],...
            '~=',0,'Floor','Wrap');

            pirelab.getWireComp(hBWEDN,...
            bWrAddrS,...
            wrAddrTempS(i),...
            'wire');
            pirelab.getWireComp(hBWEDN,...
            bWrDataS,...
            wrDataTempS(i),...
            'wire');

        end

        pirelab.getMuxComp(hBWEDN,...
        wrDataTempS(1:end),...
        wrDataS,...
        'Data');

        pirelab.getMuxComp(hBWEDN,...
        wrAddrTempS(1:end),...
        wrAddrS,...
        'Address');


        pirelab.getMuxComp(hBWEDN,...
        wrEnTempS(1:end),...
        wrEnS,...
        'WrEnable');
    else
        pirelab.getConstComp(hBWEDN,...
        constantS,...
        0,...
        'Constant','on',1,'','','');
        wrEnTempS=l_addSignal(hBWEDN,'wrEnTemp',hBoolT,slRate);
        wrAddrTempS=l_addSignal(hBWEDN,'wrAddrTempS',hbColCounterT,slRate);
        wrDataTempS=l_addSignal(hBWEDN,'wrDataTempS',inputDataT,slRate);
        compareToConstantS=l_addSignal(hBWEDN,'compareToConstant',hBoolT,slRate);
        pirelab.getCompareToValueComp(hBWEDN,...
        bRowCountS,...
        compareToConstantS,...
        '==',1,...
        'compareToConstant',0);

        pirelab.getSwitchComp(hBWEDN,...
        [bWrEnS,constantS],...
        wrEnTempS,...
        compareToConstantS,'switch',...
        '~=',0,'Floor','Wrap');

        pirelab.getWireComp(hBWEDN,...
        bWrAddrS,...
        wrAddrTempS,...
        'wire');
        pirelab.getWireComp(hBWEDN,...
        bWrDataS,...
        wrDataTempS,...
        'wire');

        pirelab.getWireComp(hBWEDN,...
        wrDataTempS,...
        wrDataS,...
        'Data');
        pirelab.getWireComp(hBWEDN,...
        wrAddrTempS,...
        wrAddrS,...
        'Address');
        pirelab.getWireComp(hBWEDN,...
        wrEnTempS,...
        wrEnS,...
        'WrEnable');
    end

end

function hS=l_addSignal(hN,sigName,pirTyp,simulinkRate)
    hS=hN.addSignal;
    hS.Name=sigName;
    hS.Type=pirTyp;
    hS.SimulinkHandle=-1;
    hS.SimulinkRate=simulinkRate;
end


