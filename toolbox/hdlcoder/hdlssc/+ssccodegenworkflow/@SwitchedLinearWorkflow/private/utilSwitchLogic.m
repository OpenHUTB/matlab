function utilSwitchLogic(voltagePortName,currentPortName,UinPortName,JOutName,subsystemName,switchValues,hdlAlgorithmDataType)



    Rs=switchValues.Rs;
    R_closed=switchValues.R_closed;
    G_open=switchValues.G_open;

    I_GainStr=strcat(hdlAlgorithmDataType,'(',num2str((R_closed-Rs)/Rs,17),')');
    V_GainStr=strcat(hdlAlgorithmDataType,'(',num2str(G_open*(1/G_open-Rs)/Rs,17),')');
    ThresholdStr=strcat(hdlAlgorithmDataType,'(',num2str(switchValues.threshold,17),')');
    hCurrentGain=add_block('simulink/Math Operations/Gain',strcat(subsystemName,'/Gain'),...
    'MakeNameUnique','on',...
    'Gain',I_GainStr,...
    'Position',[-21,-240,29,-200]);
    hVoltageGain=add_block('simulink/Math Operations/Gain',strcat(subsystemName,'/Gain1'),...
    'MakeNameUnique','on',...
    'Gain',V_GainStr,...
    'Position',[-21,-138,34,-92]);
    hSwitch=add_block('simulink/Signal Routing/Switch',strcat(subsystemName,'/Switch'),...
    'MakeNameUnique','on',...
    'Criteria','u2 > Threshold',...
    'Threshold','0',...
    'Position',[74,-190,124,-150]);

    hVtGt=add_block('simulink/Logic and Bit Operations/Relational Operator',strcat(subsystemName,'/Relational Operator'),...
    'MakeNameUnique','on',...
    'Operator','>',...
    'Position',[-16,-188,14,-157]);
    hVtConstCompare=add_block('simulink/Sources/Constant',strcat(subsystemName,'/Constant'),...
    'MakeNameUnique','on',...
    'Value',ThresholdStr,...
    'SampleTime','-1',...
    'Position',[-126,-180,-71,-150]);



    lineList={...
    currentPortName,strcat(get_param(hCurrentGain,'Name'),'/1');...
    strcat(get_param(hCurrentGain,'Name'),'/1'),strcat(get_param(hSwitch,'Name'),'/1');...
    voltagePortName,strcat(get_param(hVoltageGain,'Name'),'/1');...
    strcat(get_param(hVoltageGain,'Name'),'/1'),strcat(get_param(hSwitch,'Name'),'/3');...
    UinPortName,strcat(get_param(hVtGt,'Name'),'/1');...
    strcat(get_param(hVtConstCompare,'Name'),'/1'),strcat(get_param(hVtGt,'Name'),'/2');...
    strcat(get_param(hVtGt,'Name'),'/1'),strcat(get_param(hSwitch,'Name'),'/2');...
    strcat(get_param(hSwitch,'Name'),'/1'),JOutName};...


    add_line(subsystemName,lineList(:,1),lineList(:,2),'AutoRouting','smart')
end
