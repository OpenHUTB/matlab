function hCOPNet=getCoprocessorControllerNetwork(...
    hN,hPir,topInSignals,topOutSignals,networkName,...
    cntCycle)




    if nargin<6
        cntCycle=1;
    end

    top_in_strobe=topInSignals(1);
    top_cop_enable=topInSignals(2);
    top_out_ready=topOutSignals(1);
    top_dut_enable=topOutSignals(2);
    top_reg_strobe=topOutSignals(3);


    hCOPNet=pirelab.createNewNetwork(...
    'PirInstance',hPir,...
    'Network',hN,...
    'Name',networkName,...
    'InportNames',{'in_strobe','cop_enable'},...
    'InportTypes',[top_in_strobe.Type,top_cop_enable.Type],...
    'InportRates',[top_in_strobe.SimulinkRate,top_cop_enable.SimulinkRate],...
    'OutportNames',{'out_ready','dut_enable','reg_strobe'},...
    'OutportTypes',[top_out_ready.Type,top_dut_enable.Type,top_reg_strobe.Type]...
    );


    pirelab.instantiateNetwork(hN,hCOPNet,topInSignals,topOutSignals,...
    sprintf('%s_inst',networkName));


    in_strobe=hCOPNet.PirInputSignals(1);
    cop_enable=hCOPNet.PirInputSignals(2);
    out_ready=hCOPNet.PirOutputSignals(1);
    dut_enable=hCOPNet.PirOutputSignals(2);
    reg_strobe=hCOPNet.PirOutputSignals(3);


    [~,clkenb,~]=hCOPNet.getClockBundle(cop_enable,1,1,0);
    pirelab.getWireComp(hCOPNet,cop_enable,clkenb);


    hCOPNet.addComponent2(...
    'kind','cgireml',...
    'Name',sprintf('cp_controller'),...
    'InputSignals',in_strobe,...
    'OutputSignals',[out_ready,dut_enable,reg_strobe],...
    'EMLFileName','hdleml_coprocessor',...
    'EMLParams',{cntCycle});

end

