classdef NewProjectsSection<matlab.internal.project.preferences.sections.PreferencesSection




    methods
        function obj=NewProjectsSection(panelGrid)
            obj=obj@matlab.internal.project.preferences.sections.PreferencesSection(...
            panelGrid,i_getMessage("Header"),1);

            newProjectsSettings=settings().matlab.project.creation;

            if matlab.ui.internal.desktop.isMOTW
                defaultFolderSetting=newProjectsSettings.MODefaultFolder;
            else
                defaultFolderSetting=newProjectsSettings.DefaultFolder;
            end

            defaultFolderPref=matlab.internal.project.preferences.widgets.BrowseFolderWidget(...
            obj.SectionGrid,...
            i_getMessage("DefaultFolderPrompt"),...
            defaultFolderSetting);

            info=matlab.internal.project.metadata.getRegisteredMetadataManagersInfo();
            metadataManagerPref=matlab.internal.project.preferences.widgets.MultipleChoiceWidget(...
            obj.SectionGrid,...
            i_getMessage("DefinitionFilesPrompt"),...
            string({info.Name}),...
            string({info.Description}),...
            newProjectsSettings.DefaultMetadataManager);

            selectableMetadataRoots=matlab.internal.project.metadata.getSelectableRoots();
            metadataRootPref=matlab.internal.project.preferences.widgets.MultipleChoiceWidget(...
            obj.SectionGrid,...
            i_getMessage("DefinitionFolderPrompt"),...
            string(selectableMetadataRoots),...
            string(selectableMetadataRoots),...
            newProjectsSettings.DefaultMetadataRoot);

            showSetupGuidePref=matlab.internal.project.preferences.widgets.BooleanWidget(...
            obj.SectionGrid,...
            i_getMessage("ShowSetupGuideLabel"),...
            newProjectsSettings.ShowSetupGuide);

            obj.Preferences=[...
defaultFolderPref
metadataManagerPref
metadataRootPref
showSetupGuidePref
            ];
        end
    end
end


function value=i_getMessage(resource)
    value=string(message("MATLAB:project:preferences:NewProjects"+resource));
end
